(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{117:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return c})),a.d(t,"metadata",(function(){return m})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return s}));var n=a(2),r=a(6),i=(a(0),a(143)),c={},m={id:"hunting/network_recon/SMTP",title:"SMTP",description:"* SMTP",source:"@site/docs\\hunting\\network_recon\\SMTP.md",permalink:"/rosh/docs/hunting/network_recon/SMTP",sidebar:"huntingSidebar",previous:{title:"Proxy",permalink:"/rosh/docs/hunting/network_recon/proxy"},next:{title:"Bash Scripts",permalink:"/rosh/docs/hunting/scripts/bash_scripts"}},l=[{value:"grab banner",id:"grab-banner",children:[{value:"nmap",id:"nmap",children:[]},{value:"nc",id:"nc",children:[]}]},{value:"enumerating username",id:"enumerating-username",children:[{value:"using commands",id:"using-commands",children:[]},{value:"<code>smtp-user-enum</code>",id:"smtp-user-enum",children:[]},{value:"metasploit <code>smtp_enum</code>",id:"metasploit-smtp_enum",children:[]}]}],o={rightToc:l};function s(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.a)("wrapper",Object(n.a)({},o,a,{components:t,mdxType:"MDXLayout"}),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#smtp"}),"SMTP"),Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#grab-banner"}),"grab banner")),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#enumerating-username"}),"enumerating username"),Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#using-commands"}),"using commands")),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#smtp-user-enum"}),Object(i.a)("inlineCode",{parentName:"a"},"smtp-user-enum"))),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#metasploit-smtp_enum"}),"metasploit ",Object(i.a)("inlineCode",{parentName:"a"},"smtp_enum"))))),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#send-mail"}),"send mail"),Object(i.a)("ul",{parentName:"li"},Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#using-telnet"}),"using ",Object(i.a)("inlineCode",{parentName:"a"},"telnet"))),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"#using-sendemail"}),"using ",Object(i.a)("inlineCode",{parentName:"a"},"sendemail")))))))),Object(i.a)("h1",{id:"smtp"},"SMTP"),Object(i.a)("h2",{id:"grab-banner"},"grab banner"),Object(i.a)("h3",{id:"nmap"},"nmap"),Object(i.a)("p",null,Object(i.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#banner"}),"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#banner")),Object(i.a)("h3",{id:"nc"},"nc"),Object(i.a)("p",null,Object(i.a)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nc.md#banner-grabbing"}),"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nc.md#banner-grabbing")),Object(i.a)("h2",{id:"enumerating-username"},"enumerating username"),Object(i.a)("h3",{id:"using-commands"},"using commands"),Object(i.a)("p",null,"Refs"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"https://blog.mailtrap.io/smtp-commands-and-responses/"}),"https://blog.mailtrap.io/smtp-commands-and-responses/"))),Object(i.a)("p",null,"Enumeration is performed by inspecting the responses to VRFY, EXPN and RCPT TO commands."),Object(i.a)("h4",{id:"vrfy"},Object(i.a)("inlineCode",{parentName:"h4"},"VRFY")),Object(i.a)("pre",null,Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nVRFY admin@victim-1\n")),Object(i.a)("h4",{id:"expn"},Object(i.a)("inlineCode",{parentName:"h4"},"EXPN")),Object(i.a)("pre",null,Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nEXPN admin@victim-1\n250 2.1.5 <admin@victim-1>\n")),Object(i.a)("h4",{id:"rcpt-to"},Object(i.a)("inlineCode",{parentName:"h4"},"RCPT TO")),Object(i.a)("pre",null,Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nMAIL FROM:a@victim-1\n250 2.1.0 a@victim-1... Sender ok\nRCPT TO:admin@victim-1\n250 2.1.5 admin@victim-1... Recipient ok (will queue)\n")),Object(i.a)("h3",{id:"smtp-user-enum"},Object(i.a)("inlineCode",{parentName:"h3"},"smtp-user-enum")),Object(i.a)("p",null,"Refs :"),Object(i.a)("ul",null,Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"https://tools.kali.org/information-gathering/smtp-user-enum"}),"https://tools.kali.org/information-gathering/smtp-user-enum")),Object(i.a)("li",{parentName:"ul"},Object(i.a)("a",Object(n.a)({parentName:"li"},{href:"http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum"}),"http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum"))),Object(i.a)("pre",null,Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# Usage: smtp-user-enum.pl [options] ( -u username | -U file-of-usernames ) ( -t host | -T file-of-targets )\nsmtp-user-enum -U usernames.txt -t 192.186.235.3\n")),Object(i.a)("h3",{id:"metasploit-smtp_enum"},"metasploit ",Object(i.a)("inlineCode",{parentName:"h3"},"smtp_enum")),Object(i.a)("blockquote",null,Object(i.a)("p",{parentName:"blockquote"},"msfconsole \\\nuse auxiliary/scanner/smtp/smtp_enum \\\nset RHOSTS 192.186.235.3 \\\nexploit "),Object(i.a)("h2",Object(n.a)({parentName:"blockquote"},{id:"send-mail"}),"send mail"),Object(i.a)("h3",Object(n.a)({parentName:"blockquote"},{id:"using-telnet"}),"using ",Object(i.a)("inlineCode",{parentName:"h3"},"telnet")),Object(i.a)("pre",{parentName:"blockquote"},Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"telnet 192.186.235.3 25\nHELO attacker.xyz\nMAIL FROM: admin@attacker.xyz\nRCPT TO: root@victim-1\nDATA\nSubject: Hi Root\nHello,\nThis is a fake mail sent using telnet command.\nFrom,\nAdmin\n.\n")),Object(i.a)("p",{parentName:"blockquote"},"Note: There is a dot(.) in the last line which indicates the termination of data."),Object(i.a)("h3",Object(n.a)({parentName:"blockquote"},{id:"using-sendemail"}),"using ",Object(i.a)("inlineCode",{parentName:"h3"},"sendemail")),Object(i.a)("pre",{parentName:"blockquote"},Object(i.a)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),'$ sendemail -f admin@attacker.xyz -t root@victim-1 -s 192.91.109.3 -u Fakemail -m "Hi root, a fake from admin" -o tls=no\nMay 15 09:21:55 attackdefense sendemail[110]: Email was sent successfully!\n'))))}s.isMDXComponent=!0},143:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=r.a.createContext({}),s=function(e){var t=r.a.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):m(m({},t),e)),a},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,c=e.parentName,o=l(e,["components","mdxType","originalType","parentName"]),u=s(a),b=n,O=u["".concat(c,".").concat(b)]||u[b]||p[b]||i;return a?r.a.createElement(O,m(m({ref:t},o),{},{components:a})):r.a.createElement(O,m({ref:t},o))}));function b(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,c=new Array(i);c[0]=u;var m={};for(var l in t)hasOwnProperty.call(t,l)&&(m[l]=t[l]);m.originalType=e,m.mdxType="string"==typeof e?e:n,c[1]=m;for(var o=2;o<i;o++)c[o]=a[o];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);