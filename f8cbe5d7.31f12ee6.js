(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{101:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return m}));var n=a(0),c=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,c=function(e,t){if(null==e)return{};var a,n,c={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(c[a]=e[a]);return c}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}var b=c.a.createContext({}),h=function(e){var t=c.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},o=function(e){var t=h(e.components);return c.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return c.a.createElement(c.a.Fragment,{},t)}},d=c.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),o=h(a),d=n,m=o["".concat(s,".").concat(d)]||o[d]||p[d]||r;return a?c.a.createElement(m,i(i({ref:t},b),{},{components:a})):c.a.createElement(m,i({ref:t},b))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,s=new Array(r);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,s[1]=i;for(var b=2;b<r;b++)s[b]=a[b];return c.a.createElement.apply(null,s)}return c.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},95:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return s})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return h}));var n=a(2),c=a(6),r=(a(0),a(101)),s={title:"Password Cracking",sidebar_label:"Password Cracking"},i={unversionedId:"hunting/password_cracking",id:"hunting/password_cracking",isDocsHomePage:!1,title:"Password Cracking",description:"* hash-identifier",source:"@site/docs\\hunting\\password_cracking.md",permalink:"/rosh/docs/hunting/password_cracking",sidebar_label:"Password Cracking",sidebar:"huntingSidebar",previous:{title:"MITRE",permalink:"/rosh/docs/hunting/MITRE"},next:{title:"persistence",permalink:"/rosh/docs/hunting/persistence"}},l=[{value:"findmyhash",id:"findmyhash",children:[]},{value:"example hashes",id:"example-hashes",children:[]},{value:"show delete found password",id:"show-delete-found-password",children:[]},{value:"Mask Based Attack",id:"mask-based-attack",children:[{value:"Setup Mask",id:"setup-mask",children:[]},{value:"Increment Mode",id:"increment-mode",children:[]},{value:"Hashcat Mask Files",id:"hashcat-mask-files",children:[]}]},{value:"Dictionary Attack",id:"dictionary-attack",children:[]},{value:"MD5",id:"md5",children:[]},{value:"HMAC",id:"hmac",children:[]},{value:"CRC32",id:"crc32",children:[]},{value:"SHA1",id:"sha1",children:[]},{value:"NTLM",id:"ntlm",children:[]},{value:"MD5Crypt",id:"md5crypt",children:[]},{value:"Bcrypt",id:"bcrypt",children:[]},{value:"Generate a custom wordlist",id:"generate-a-custom-wordlist",children:[]},{value:"john pot file",id:"john-pot-file",children:[{value:"How to clear crakced hash from database",id:"how-to-clear-crakced-hash-from-database",children:[]}]},{value:"RAR",id:"rar",children:[]},{value:"PKZIP",id:"pkzip",children:[]},{value:"MS word .docx",id:"ms-word-docx",children:[]},{value:"MS word .doc",id:"ms-word-doc",children:[]},{value:"WEP",id:"wep",children:[]}],b={rightToc:l};function h(e){var t=e.components,a=Object(c.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#hash-identifier"}),Object(r.b)("inlineCode",{parentName:"a"},"hash-identifier"))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#hash-online-websites"}),"hash online websites")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#hashcat"}),"Hashcat"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#example-hashes"}),"example hashes")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#show-delete-found-password"}),"show delete found password")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#mask-based-attack"}),"Mask Based Attack"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#setup-mask"}),"Setup Mask")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#increment-mode"}),"Increment Mode")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#hashcat-mask-files"}),"Hashcat Mask Files")))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#dictionary-attack"}),"Dictionary Attack")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#md5"}),"MD5")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#hmac"}),"HMAC")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#crc32"}),"CRC32")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#sha1"}),"SHA1")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#ntlm"}),"NTLM")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#md5Crypt"}),"MD5Crypt")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#bcrypt"}),"Bcrypt"),"  "))),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#wordlists"}),"Wordlists")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#john-the-ripper"}),"john the ripper")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#protected-files"}),"Protected Files"),Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#rar"}),"RAR")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#pkzip"}),"PKZIP")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#ms-word-docx"}),"MS word .docx")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#ms-word-doc"}),"MS word .doc"))))),Object(r.b)("h1",{id:"hash-identifier"},Object(r.b)("inlineCode",{parentName:"h1"},"hash-identifier")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://tools.kali.org/password-attacks/hash-identifier"}),"https://tools.kali.org/password-attacks/hash-identifier"))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"hash-identifier\n")),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Any hash with ",Object(r.b)("inlineCode",{parentName:"li"},"32")," characters is ",Object(r.b)("inlineCode",{parentName:"li"},"MD5"))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"echo -n 8743b52063cd84097a65d1633f5c74f5 | wc -c\n32\n")),Object(r.b)("h1",{id:"hash-online-websites"},"hash online websites"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://hashes.org/search.php"}),"https://hashes.org/search.php")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://hashes.com/en/decrypt/hash"}),"https://hashes.com/en/decrypt/hash"))),Object(r.b)("h2",{id:"findmyhash"},"findmyhash"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://tools.kali.org/password-attacks/findmyhash"}),"https://tools.kali.org/password-attacks/findmyhash"))),Object(r.b)("p",null,"Specifying the hash algorithm ",Object(r.b)("inlineCode",{parentName:"p"},"MD5"),", attempt to crack the given hash ",Object(r.b)("inlineCode",{parentName:"p"},"-h 098f6bcd4621d373cade4e832627b4f6"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"root@kali:~# findmyhash MD5 -h 098f6bcd4621d373cade4e832627b4f6\n")),Object(r.b)("h1",{id:"hashcat"},"Hashcat"),Object(r.b)("h2",{id:"example-hashes"},"example hashes"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://hashcat.net/wiki/doku.php?id=example_hashes"}),"https://hashcat.net/wiki/doku.php?id=example_hashes"))),Object(r.b)("h2",{id:"show-delete-found-password"},"show delete found password"),Object(r.b)("p",null,"To show an existing cracked password use ",Object(r.b)("inlineCode",{parentName:"p"},"--show")," flag in the end like"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 0 -a 0 digest.txt /usr/share/wordlists/rockyou.txt --force --show\n")),Object(r.b)("p",null,"You can disable potfile support completely by using ",Object(r.b)("inlineCode",{parentName:"p"},"--potfile-disable")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# find hashcat.potfile\nfind / -type f -name 'hashcat.potfile'\n\n# -n tells echo not to output the trailing newline\necho -n \"\" > /hashcat/hashcat-4.2.1/hashcat.potfile\n")),Object(r.b)("h2",{id:"mask-based-attack"},"Mask Based Attack"),Object(r.b)("h3",{id:"setup-mask"},"Setup Mask"),Object(r.b)("p",null,"Refs"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://hashcat.net/wiki/doku.php?id=mask_attack"}),"https://hashcat.net/wiki/doku.php?id=mask_attack")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.4armed.com/blog/perform-mask-attack-hashcat/"}),"https://www.4armed.com/blog/perform-mask-attack-hashcat/"))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"command: -a 3 -1 ?l?d ?1?1?1?1?1\nkeyspace: aaaaa - 99999\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# password length is 5 characters\n# password can only contain characters from this character set:  a-z, 0-9\nhashcat -m 0 -a 3 digest.txt -1 ?l?d ?1?1?1?1?1\n")),Object(r.b)("h3",{id:"increment-mode"},"Increment Mode"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# If you take the mask \u201c?l?l?l?l?l?l?l\u201d it will only try passwords of that length. To cycle through all the possible combinations from \n# one to seven, the \u201c--increment argument\u201d can be used.\n?l\n?l?l\n?l?l?l\n?l?l?l?l\n?l?l?l?l?l\n?l?l?l?l?l?l?l\n")),Object(r.b)("p",null,"In order to limit the increment within a specified range use ",Object(r.b)("inlineCode",{parentName:"p"},"--increment-min")," and ",Object(r.b)("inlineCode",{parentName:"p"},"increment-max")," options"),Object(r.b)("h3",{id:"hashcat-mask-files"},"Hashcat Mask Files"),Object(r.b)("p",null,"Let us consider the following scenario for creating a password masking attack:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Length between five and eight characters"),Object(r.b)("li",{parentName:"ul"},"Always starts with a capital letter"),Object(r.b)("li",{parentName:"ul"},"Always ends with a number"),Object(r.b)("li",{parentName:"ul"},"The characters in the middle are either lower or upper case")),Object(r.b)("p",null,"For a single entry in a mask file, the following structure is used:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"charset1,charset2,charset3,charset4,mask\n")),Object(r.b)("p",null,"It's important to highlight that the charset parameters are optional. So it's possible to create entries in the following format:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"charset1,charset2,charset3,charset4,mask\ncharset1,charset2,mask\nmask\n")),Object(r.b)("p",null,"To meet the previous scenario, we can create a mask file containing the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"?u,?u?l,?d,?1?2?2?2?3\n?u,?u?l,?d,?1?2?2?2?2?3\n?u,?u?l,?d,?1?2?2?2?2?2?3\n")),Object(r.b)("p",null,"Mask files have the file extension of ",Object(r.b)("inlineCode",{parentName:"p"},".hcmask")," and can be used from the command line like below:"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 0 -a 3 hash masks.hcmask\n")),Object(r.b)("h2",{id:"dictionary-attack"},"Dictionary Attack"),Object(r.b)("p",null,"Refs:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-passwords-part-3-using-hashcat-0156543/"}),"https://null-byte.wonderhowto.com/how-to/hack-like-pro-crack-passwords-part-3-using-hashcat-0156543/"))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 1800 -a 0 hash.lst wordlist.txt\n")),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"-m")," 1800 designates the type of hash we are cracking (SHA-512)"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"-a 0")," designates a dictionary attack"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"hash.lst")," is our input file of hashes"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"wordlist.txt")," is the absolute path to our wordlist for this dictionary attack"),Object(r.b)("h2",{id:"md5"},"MD5"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Any hash with ",Object(r.b)("inlineCode",{parentName:"li"},"32")," characters is ",Object(r.b)("inlineCode",{parentName:"li"},"MD5"))),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"echo -n 8743b52063cd84097a65d1633f5c74f5 | wc -c\n32\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# -m 0 : MD5 without salt\n\n# MD5 hash:salt \n# cf0b18ddb1a31d05fc73f50fcd29e0a8:salt123\nhashcat -m 10 -a 0 digest.txt password-seclists.txt\n")),Object(r.b)("h2",{id:"hmac"},"HMAC"),Object(r.b)("p",null,"HMAC is a keyed hash (authenticated hash) scheme which ensures that a specific hash value can only be generated if the entity possess a secret key. This scheme can be used to turn any existing hash function into an authenticated hash function which can be then used to check the authenticity of the message in addition to its integrity. HMAC-SHA1 was widely used in online banking security, HTTPS, VPN connections in addition to verify the integrity of the files/binaries. In essence, it is mostly used to protect the data in transit over insecure mediums. "),Object(r.b)("p",null,"A plain-text string and corresponding HMAC-SHA1 digest is provided in digest.txt file. The key used to generate the HMAC-SHA1 is either taken from a key dictionary or by using the key policy. The ",Object(r.b)("inlineCode",{parentName:"p"},"digest.txt")," file and the dictionary file ",Object(r.b)("inlineCode",{parentName:"p"},"password-seclists.txt")," is present in the user's home directory."),Object(r.b)("p",null,"Objective: Recover the secret key."),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"150\tHMAC-SHA1 (key = $pass)\tc898896f3f70f61bc3fb19bef222aa860e5ea717:1234")," from ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://hashcat.net/wiki/doku.php?id=example_hashes"}),"example hashes")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# \n# hash:plaintext\n# 69f7e54d484620ed6e9d731ca51780a000463fc2:tinkerbell97\nhashcat -m 150 -a 0 digest.txt password-seclists.txt\n")),Object(r.b)("h2",{id:"crc32"},"CRC32"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"11500\tCRC32 5\tc762de4a:00000000")," from ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://hashcat.net/wiki/doku.php?id=example_hashes"}),"example hashes")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 11500 -a 0 digest.txt password-seclists.txt\n")),Object(r.b)("h2",{id:"sha1"},"SHA1"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 100 digest.txt -a 0 password-seclists.txt\n")),Object(r.b)("h2",{id:"ntlm"},"NTLM"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 1000 -a 0 digest.txt password-seclists.txt\n")),Object(r.b)("h2",{id:"md5crypt"},"MD5Crypt"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"hashcat -m 500 digest.txt -a 0 1000000-password-seclists.txt\n")),Object(r.b)("h2",{id:"bcrypt"},"Bcrypt"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"Bcrypt")," is a popular 184-bit password hashing function designed by Niels Provos and David Mazi\xe8res in 1999. It is based on ",Object(r.b)("inlineCode",{parentName:"p"},"blowfish")," cipher.  It is default password hashing algorithm for OpenBSD and other OSes like SUSE Linux."),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"$ cat digest.txt\nDigest: gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W\nRounds: 4\n")),Object(r.b)("p",null,"This input format is not compatible to Hashcat. So, modify it"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"$ cat digest.txt\n$2a$04$gLX3.eb.sPNURq3Y87bx/eUC9Ysw6mZhi1HAWvy07DWYyw9zYI3.W\n\nhashcat -m 3200 -a 0 digest.txt password-seclists.txt\n")),Object(r.b)("h1",{id:"wordlists"},"Wordlists"),Object(r.b)("h2",{id:"generate-a-custom-wordlist"},"Generate a custom wordlist"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"CeWL")," is a ruby app which spiders a given url to a specified depth, optionally following external links, and returns a list of words which can then be used for password crackers such as John the Ripper.\nRefer : ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://tools.kali.org/password-attacks/cewl"}),"https://tools.kali.org/password-attacks/cewl")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"cewl -w createWordlist.txt -m <min password length> https://www.example.com\n")),Object(r.b)("p",null,"Scan to a depth of 2 ",Object(r.b)("inlineCode",{parentName:"p"},"-d 2")," and use a minimum word length of 5 ",Object(r.b)("inlineCode",{parentName:"p"},"-m 5"),", save the words to a file ",Object(r.b)("inlineCode",{parentName:"p"},"-w docswords.txt"),", targeting the given URL (",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://example.com"}),"https://example.com"),"):"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"cewl -d 2 -m 5 -w docswords.txt https://example.com\n")),Object(r.b)("h1",{id:"john-the-ripper"},"john the ripper"),Object(r.b)("p",null,"John HASH cracking using dictionary"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"john --wordlist=/user/share/wordlists/rockyou.txt hash.txt\n")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),"MD5\n$ john --format=raw-md5 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\n\nSHA1\n$ john --format=raw-sha1 hashes.txt\n\nSHA224\n$ john --format=raw-sha224 hashes.txt\n\nSHA512\n$ john --format=raw-sha512 hashes.txt\n")),Object(r.b)("p",null,"Other hash formats supported by John the Ripper: ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"http://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats"}),"http://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats")),Object(r.b)("h2",{id:"john-pot-file"},"john pot file"),Object(r.b)("h3",{id:"how-to-clear-crakced-hash-from-database"},"How to clear crakced hash from database"),Object(r.b)("p",null,"As you can see in the docs ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"http://www.openwall.com/john/doc/"}),"http://www.openwall.com/john/doc/"),", John (and almost any good hash cracker) will store the\ncracked hashes in some sort of file/db.\nThis is for performance, this programs will check for already cracked hashes preventing them to spend cpu/gpu time.\nIn the case of John, is located at: ",Object(r.b)("inlineCode",{parentName:"p"},"$JOHN/john.pot")," (",Object(r.b)("inlineCode",{parentName:"p"},"$JOHN")," path depends on the install). You can view the previously\ncracked hashes in the terminal with the command: ",Object(r.b)("inlineCode",{parentName:"p"},"john --show passwd")),Object(r.b)("h1",{id:"protected-files"},"Protected Files"),Object(r.b)("h2",{id:"rar"},"RAR"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# extract hashes of .rar file\nrar2john archive.rar > hash\n\ncat hash\n$rar5$16$50d889a2c6441510dd0c8ab76dde4fd6$15$697757daca178f6f88135491827bdad6$8$e13f0c4d2f8286d5\n\njohn --wordlist=password-seclists.txt hash\nhashcat -m 13000 hash -a 0 password-seclists.txt\n")),Object(r.b)("h2",{id:"pkzip"},"PKZIP"),Object(r.b)("p",null,"We have to use JTR because at the time of writing this document, PKZIP is not supported by hashcat"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# extract hashes of .zip file\nzip2john archive.zip > hash\n\ncat hash\narchive.zip:$pkzip2$1*2*2*0*2d*21*c10509e*0*3f*0*2d*0c10*360a*f5e92c2b27b0f6ece97e6030ccb3338eb42b7c5ec117f4b49bfb0232e1e45e1673c6ef2fb8c952ba2410a770aa*$/pkzip2$:::::archive.zip\n\njohn --wordlist=1000000-password-seclists.txt hash\n")),Object(r.b)("h2",{id:"ms-word-docx"},"MS word .docx"),Object(r.b)("p",null,"MS Office 2013"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# extract hashes of .docx file\noffice2john MS_Word_Document.docx > hash\n\n$ cat hash\nMS_Word_Document.docx:$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2\n\njohn --wordlist=password-seclists.txt hash\n")),Object(r.b)("p",null,"Using Hashcat"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# Make the hashes compatible with hashcat\ncat hash\n$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2\n\nhashcat -m 9600 hash -a 0 password-seclists.txt\n")),Object(r.b)("h2",{id:"ms-word-doc"},"MS word .doc"),Object(r.b)("p",null,"MS Office 1997-2003"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"office2john MS_Word_Document_97_2003.doc > hash\n\n$ cat hash\nMS_Word_Document_97_2003.doc:$oldoffice$4*f1efb1c529cff63cb08cf439df074c5d*9256d6abe8325534e7dae97f9f5967d9*8f015d410f45812c5e554ab7a147f1d9285ff6ea:::::MS_Word_Document_97_2003.doc\n\njohn --wordlist=password-seclists.txt hash\n")),Object(r.b)("p",null,"Using Hashcat"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# Make the hashes compatible with hashcat\ncat hash\n$oldoffice$4*f1efb1c529cff63cb08cf439df074c5d*9256d6abe8325534e7dae97f9f5967d9*8f015d410f45812c5e554ab7a147f1d9285ff6ea\n\nhashcat -m 9800 hash -a 0 password-seclists.txt\n")),Object(r.b)("h1",{id:"wifi"},"WiFi"),Object(r.b)("h2",{id:"wep"},"WEP"),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"# -b <bssid> : target selection: access point's MAC\naircrack-ng -b 00:21:91:d2:8e:25 WEP-Cracking.cap\n")))}h.isMDXComponent=!0}}]);