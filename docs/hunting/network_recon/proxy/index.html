<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<title data-react-helmet="true">Proxy | Musings</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Proxy | Musings"><meta data-react-helmet="true" name="description" content="* Proxy"><meta data-react-helmet="true" property="og:description" content="* Proxy"><meta data-react-helmet="true" property="og:url" content="https://jai-the-seeker.github.io/rosh/docs/hunting/network_recon/proxy"><link data-react-helmet="true" rel="shortcut icon" href="/rosh/img/symbol.png"><link data-react-helmet="true" rel="canonical" href="https://jai-the-seeker.github.io/rosh/docs/hunting/network_recon/proxy"><link rel="stylesheet" href="/rosh/styles.cadbe1e8.css">
<link rel="preload" href="/rosh/styles.732cfda7.js" as="script">
<link rel="preload" href="/rosh/runtime~main.1dafc50a.js" as="script">
<link rel="preload" href="/rosh/main.331acb28.js" as="script">
<link rel="preload" href="/rosh/1.8a5062f9.js" as="script">
<link rel="preload" href="/rosh/2.2de74e1c.js" as="script">
<link rel="preload" href="/rosh/3.98b09a97.js" as="script">
<link rel="preload" href="/rosh/1be78505.81b77194.js" as="script">
<link rel="preload" href="/rosh/44.f4576be6.js" as="script">
<link rel="preload" href="/rosh/5908942f.7a243fa6.js" as="script">
<link rel="preload" href="/rosh/bf461d7f.55a7e8a3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/rosh/"><img class="navbar__logo" src="/rosh/img/symbol.png" alt="My Site Logo"><strong class="navbar__title">Musings</strong></a><a class="navbar__item navbar__link" href="/rosh/docs/hunting/field-manual">Red Hunters</a><a class="navbar__item navbar__link" href="/rosh/docs/web_security/sessions">Web Security</a><a class="navbar__item navbar__link" href="/rosh/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/rosh/"><img class="navbar__logo" src="/rosh/img/symbol.png" alt="My Site Logo"><strong class="navbar__title">Musings</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/rosh/docs/hunting/field-manual">Red Hunters</a></li><li class="menu__list-item"><a class="menu__link" href="/rosh/docs/web_security/sessions">Web Security</a></li><li class="menu__list-item"><a class="menu__link" href="/rosh/blog">Blog</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Hunting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/field-manual">Red Hunters Field Manual</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Network Recon</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/rosh/docs/hunting/network_recon/proxy">Proxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/rosh/docs/hunting/network_recon/SMTP">SMTP</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Scripts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/scripts/bash_scripts">Bash Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/scripts/python_scripts">Python Scripts</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Utilities</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/utilities/curl">curl</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/utilities/nc">nc</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/utilities/nmap">nmap</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/utilities/ssh">ssh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/utilities/tshark">tshark</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/web/sql_injection">SQL Injection</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/web/web_recon">Web Recon</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Misc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/forensics">Forensics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/linux_deb_backdoor">linux_deb_backdoor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/linux_priv_esc">Linux Privilege Escalation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/MITRE">MITRE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/password_cracking">Password Cracking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/persistence">persistence</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">OverTheWire</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/rosh/docs/hunting/bandit">bandit</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Proxy</h1></header><div class="markdown"><ul><li><a href="#proxy">Proxy</a><ul><li><a href="#proxy-authentication">Proxy Authentication</a><ul><li><a href="#open-authentication">Open Authentication</a></li><li><a href="#username-and-password">username and password</a></li><li><a href="#bruteforce">bruteforce</a></li></ul></li><li><a href="#proxychains">Proxychains</a><ul><li><a href="#configure-proxychain">Configure proxychain</a></li><li><a href="#proxychain-with-nmap">Proxychain with <code>nmap</code></a></li><li><a href="#proxychain-with-curl">Proxychain with <code>curl</code></a></li></ul></li></ul></li></ul><h1 id="proxy">Proxy</h1><h2 id="proxy-authentication">Proxy Authentication</h2><h3 id="open-authentication">Open Authentication</h3><p>If the proxy is configured with authentication, any attempts made via proxy will return an <code>access denied</code> error. In case the proxy is configured without authentication, the connection will be forwarded by the proxy and the error message will be different than <code>Access denied</code> error.</p><p>By using the command <code>curl -x 192.201.208.3:3128 127.0.0.1</code>. We are looking for a different error message than <code>Access Denied</code>. Provided the proxy does not use any authentication, in case if a service is running, (for e.g an apache server) an HTTP response will be received, if no service is running then the connection refused error will be received. Either of the error will confirm that the proxy is configured without authentication. The following example shows that squid proxy is configured without authentication.</p><pre><code class="language-sh">$ curl -i -x 192.234.192.3:3128 127.0.0.1

HTTP/1.1 503 Service Unavailable
Server: squid/3.5.12
...
X-Squid-Error: ERR_CONNECT_FAIL 111
Vary: Accept-Language
Content-Language: en
X-Cache: MISS from victim-1
X-Cache-Lookup: MISS from victim-1:3128
Via: 1.1 victim-1 (squid/3.5.12)
Connection: keep-alive

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
&lt;html&gt;&lt;head&gt;
&lt;meta type=&quot;copyright&quot; content=&quot;Copyright (C) 1996-2015 The Squid Software Foundation and contributors&quot;&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; CONTENT=&quot;text/html; charset=utf-8&quot;&gt;
&lt;title&gt;ERROR: The requested URL could not be retrieved&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;&lt;!-- 
...
.
&lt;blockquote id=&quot;error&quot;&gt;
&lt;p&gt;&lt;b&gt;Connection to 127.0.0.1 failed.&lt;/b&gt;&lt;/p&gt;
&lt;/blockquote&gt;
...
</code></pre><h3 id="username-and-password">username and password</h3><p><a href="https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#username-and-password-for-proxy">https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/curl.md#username-and-password-for-proxy</a></p><h3 id="bruteforce">bruteforce</h3><h4 id="nmap">nmap</h4><p><a href="https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#http-proxy-brute">https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#http-proxy-brute</a></p><h4 id="bash-script">bash script</h4><p><a href="https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts/bash_scripts.md#proxy-authentication-dictionary-attk">https://github.com/jai-the-seeker/CTF-OSCP/blob/master/scripts/bash_scripts.md#proxy-authentication-dictionary-attk</a></p><h2 id="proxychains">Proxychains</h2><p>Proxychains is a tool which forces the TCP connection to go through the configured proxy(s). Proxychians can force the connection through multiple proxy servers. For e.g, if you have the following proxychains configuration (with strict chain option):</p><ul><li>socks5 192.200.34.4</li><li>socks5 192.200.33.5</li><li>socks4 192.200.32.6</li></ul><p>The TCP connection will be sent through proxy servers in the following order.</p><blockquote><p>Host  &lt;---&gt; 192.200.34.4  &lt;---&gt;192.200.33.5 &lt;---&gt; 192.200.32.6 &lt;---&gt; Target</p></blockquote><p>If any of the proxy servers fails to connect, the TCP connection won&#x27;t be established. To skip a dead proxy server and move on to the next proxy server <em>Dynamic chain</em> option is used.</p><p>The <em>random chain</em> option is used to randomly select the order of the proxy server for forwarding the TCP connection.</p><p>Upon starting a program, for e.g Mozilla Firefox with the command: <code>proxychains firefox</code>, All the TCP traffic of Mozilla Firefox will be forced through the proxy server.</p><h3 id="configure-proxychain">Configure proxychain</h3><pre><code class="language-sh">cat /etc/proxychains.conf

# Add details of http proxy at the end of the file
http 192.234.192.3 3128
</code></pre><h3 id="proxychain-with-nmap">Proxychain with <code>nmap</code></h3><p>We can use proxychain, to scan the target machine, we are forcing the traffic of <code>nmap</code> to go through the HTTP Proxy server.</p><ul><li>Since, we have configured <code>http</code> proxy, we need to use <code>-sT</code> flag with <code>nmap</code>.</li></ul><pre><code class="language-sh">proxychains nmap -sV -sT -p- 127.0.0.1
</code></pre><p>Please note: nmap also has an <code>--proxies</code> option. But it is not used as it does not work as expected, On the Nmap documentation (<a href="https://nmap.org/book/man-bypass-firewalls-ids.html">https://nmap.org/book/man-bypass-firewalls-ids.html</a>), it is mentioned that the feature is till under development and has limitations.</p><h3 id="proxychain-with-curl">Proxychain with <code>curl</code></h3><pre><code class="language-sh">curl -x 192.201.208.3:3128 127.0.0.1:1337

# The above command is same as
proxychains curl 127.0.0.1:1337
</code></pre></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/rosh/docs/hunting/field-manual"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Red Hunters Field Manual</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/rosh/docs/hunting/network_recon/SMTP"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SMTP »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#proxy-authentication" class="table-of-contents__link">Proxy Authentication</a><ul><li><a href="#open-authentication" class="table-of-contents__link">Open Authentication</a></li><li><a href="#username-and-password" class="table-of-contents__link">username and password</a></li><li><a href="#bruteforce" class="table-of-contents__link">bruteforce</a></li></ul></li><li><a href="#proxychains" class="table-of-contents__link">Proxychains</a><ul><li><a href="#configure-proxychain" class="table-of-contents__link">Configure proxychain</a></li><li><a href="#proxychain-with-nmap" class="table-of-contents__link">Proxychain with <code>nmap</code></a></li><li><a href="#proxychain-with-curl" class="table-of-contents__link">Proxychain with <code>curl</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Videos</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item">Youtube</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item">Github</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social Media</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item">Twitter</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 jai-the-seeker.</div></div></div></footer></div>
<script src="/rosh/styles.732cfda7.js"></script>
<script src="/rosh/runtime~main.1dafc50a.js"></script>
<script src="/rosh/main.331acb28.js"></script>
<script src="/rosh/1.8a5062f9.js"></script>
<script src="/rosh/2.2de74e1c.js"></script>
<script src="/rosh/3.98b09a97.js"></script>
<script src="/rosh/1be78505.81b77194.js"></script>
<script src="/rosh/44.f4576be6.js"></script>
<script src="/rosh/5908942f.7a243fa6.js"></script>
<script src="/rosh/bf461d7f.55a7e8a3.js"></script>
</body>
</html>