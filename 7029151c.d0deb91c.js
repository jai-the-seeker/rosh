(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return O}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=r.a.createContext({}),l=function(e){var t=r.a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},s=function(e){var t=l(e.components);return r.a.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,o=m(e,["components","mdxType","originalType","parentName"]),s=l(n),p=a,O=s["".concat(c,".").concat(p)]||s[p]||u[p]||i;return n?r.a.createElement(O,b(b({ref:t},o),{},{components:n})):r.a.createElement(O,b({ref:t},o))}));function O(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,c=new Array(i);c[0]=p;var b={};for(var m in t)hasOwnProperty.call(t,m)&&(b[m]=t[m]);b.originalType=e,b.mdxType="string"==typeof e?e:a,c[1]=b;for(var o=2;o<i;o++)c[o]=n[o];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},73:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return m})),n.d(t,"default",(function(){return l}));var a=n(2),r=n(6),i=(n(0),n(101)),c={},b={unversionedId:"hunting/network_recon/SMTP",id:"hunting/network_recon/SMTP",isDocsHomePage:!1,title:"SMTP",description:"* SMTP",source:"@site/docs\\hunting\\network_recon\\SMTP.md",permalink:"/rosh/docs/hunting/network_recon/SMTP",sidebar:"huntingSidebar",previous:{title:"Proxy",permalink:"/rosh/docs/hunting/network_recon/proxy"},next:{title:"Bash Scripts",permalink:"/rosh/docs/hunting/scripts/bash_scripts"}},m=[{value:"grab banner",id:"grab-banner",children:[{value:"nmap",id:"nmap",children:[]},{value:"nc",id:"nc",children:[]}]},{value:"enumerating username",id:"enumerating-username",children:[{value:"using commands",id:"using-commands",children:[]},{value:"<code>smtp-user-enum</code>",id:"smtp-user-enum",children:[]},{value:"metasploit <code>smtp_enum</code>",id:"metasploit-smtp_enum",children:[]}]}],o={rightToc:m};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},o,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#smtp"}),"SMTP"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#grab-banner"}),"grab banner")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#enumerating-username"}),"enumerating username"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#using-commands"}),"using commands")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#smtp-user-enum"}),Object(i.b)("inlineCode",{parentName:"a"},"smtp-user-enum"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#metasploit-smtp_enum"}),"metasploit ",Object(i.b)("inlineCode",{parentName:"a"},"smtp_enum"))))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#send-mail"}),"send mail"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#using-telnet"}),"using ",Object(i.b)("inlineCode",{parentName:"a"},"telnet"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"#using-sendemail"}),"using ",Object(i.b)("inlineCode",{parentName:"a"},"sendemail")))))))),Object(i.b)("h1",{id:"smtp"},"SMTP"),Object(i.b)("h2",{id:"grab-banner"},"grab banner"),Object(i.b)("h3",{id:"nmap"},"nmap"),Object(i.b)("p",null,Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#banner"}),"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nmap.md#banner")),Object(i.b)("h3",{id:"nc"},"nc"),Object(i.b)("p",null,Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nc.md#banner-grabbing"}),"https://github.com/jai-the-seeker/CTF-OSCP/blob/master/utilities/nc.md#banner-grabbing")),Object(i.b)("h2",{id:"enumerating-username"},"enumerating username"),Object(i.b)("h3",{id:"using-commands"},"using commands"),Object(i.b)("p",null,"Refs"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://blog.mailtrap.io/smtp-commands-and-responses/"}),"https://blog.mailtrap.io/smtp-commands-and-responses/"))),Object(i.b)("p",null,"Enumeration is performed by inspecting the responses to VRFY, EXPN and RCPT TO commands."),Object(i.b)("h4",{id:"vrfy"},Object(i.b)("inlineCode",{parentName:"h4"},"VRFY")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nVRFY admin@victim-1\n")),Object(i.b)("h4",{id:"expn"},Object(i.b)("inlineCode",{parentName:"h4"},"EXPN")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nEXPN admin@victim-1\n250 2.1.5 <admin@victim-1>\n")),Object(i.b)("h4",{id:"rcpt-to"},Object(i.b)("inlineCode",{parentName:"h4"},"RCPT TO")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"netcat 192.91.109.3 25\nHELP\nHELO abc\nMAIL FROM:a@victim-1\n250 2.1.0 a@victim-1... Sender ok\nRCPT TO:admin@victim-1\n250 2.1.5 admin@victim-1... Recipient ok (will queue)\n")),Object(i.b)("h3",{id:"smtp-user-enum"},Object(i.b)("inlineCode",{parentName:"h3"},"smtp-user-enum")),Object(i.b)("p",null,"Refs :"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://tools.kali.org/information-gathering/smtp-user-enum"}),"https://tools.kali.org/information-gathering/smtp-user-enum")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum"}),"http://pentestmonkey.net/tools/user-enumeration/smtp-user-enum"))),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"# Usage: smtp-user-enum.pl [options] ( -u username | -U file-of-usernames ) ( -t host | -T file-of-targets )\nsmtp-user-enum -U usernames.txt -t 192.186.235.3\n")),Object(i.b)("h3",{id:"metasploit-smtp_enum"},"metasploit ",Object(i.b)("inlineCode",{parentName:"h3"},"smtp_enum")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"msfconsole \\\nuse auxiliary/scanner/smtp/smtp_enum \\\nset RHOSTS 192.186.235.3 \\\nexploit "),Object(i.b)("h2",Object(a.a)({parentName:"blockquote"},{id:"send-mail"}),"send mail"),Object(i.b)("h3",Object(a.a)({parentName:"blockquote"},{id:"using-telnet"}),"using ",Object(i.b)("inlineCode",{parentName:"h3"},"telnet")),Object(i.b)("pre",{parentName:"blockquote"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),"telnet 192.186.235.3 25\nHELO attacker.xyz\nMAIL FROM: admin@attacker.xyz\nRCPT TO: root@victim-1\nDATA\nSubject: Hi Root\nHello,\nThis is a fake mail sent using telnet command.\nFrom,\nAdmin\n.\n")),Object(i.b)("p",{parentName:"blockquote"},"Note: There is a dot(.) in the last line which indicates the termination of data."),Object(i.b)("h3",Object(a.a)({parentName:"blockquote"},{id:"using-sendemail"}),"using ",Object(i.b)("inlineCode",{parentName:"h3"},"sendemail")),Object(i.b)("pre",{parentName:"blockquote"},Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sh"}),'$ sendemail -f admin@attacker.xyz -t root@victim-1 -s 192.91.109.3 -u Fakemail -m "Hi root, a fake from admin" -o tls=no\nMay 15 09:21:55 attackdefense sendemail[110]: Email was sent successfully!\n'))))}l.isMDXComponent=!0}}]);